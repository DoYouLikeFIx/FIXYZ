"Summary","Work Type","Description","Label 1","Label 2","Label 3","Label 4","Label 5","Epic Link"
"Story 0.1: BE Core Platform Baseline","Story","Story 0.1: BE Core Platform Baseline

Status: ready-for-dev

Story

As a backend engineer,
I want a stable multi-module platform baseline,
so that all system lanes can build on a consistent runtime and coding contract.

Acceptance Criteria

- Given a clean checkout, when `./gradlew build` runs from repo root, then all backend modules compile without error.
- Given docker compose setup files, when `docker compose up` is executed, then `channel`, `corebank`, `fep-gateway`, and `fep-simulator` become healthy.
- Given Flyway configuration for channel/corebank schemas, when services start, then baseline migrations and local/test seed data run without error.
- Given internal service boundaries, when `/internal/**` or `/fep-internal/**` is called without internal secret header, then request is blocked by scaffold filter.
- Given common error contract requirement, when API exception occurs, then standardized error schema is returned.
- Given local developer visibility requirements, when `docker-compose.override.yml` is applied, then MySQL/Redis/internal service ports are reachable for local tools only.

Tasks / Subtasks

- [ ] Create and verify 8-module backend skeleton with explicit dependency direction (AC: 1)
  - [ ] Ensure module roles match architecture: `core-common`, `testing-support`, `channel-domain`, `channel-service`, `corebank-domain`, `corebank-service`, `fep-gateway`, `fep-simulator`
  - [ ] Enforce dependency rule: `core-common` has zero Spring dependency and no downstream module imports
- [ ] Implement compose baseline with health and startup sequencing (AC: 2, 6)
  - [ ] Add `depends_on: condition: service_healthy` sequencing
  - [ ] Ensure default compose exposes only channel externally; keep internal services isolated by default
  - [ ] Add local-only override for host port debugging
- [ ] Implement baseline Flyway migrations and repeatable local/test seed strategy (AC: 3)
  - [ ] Add `V1__create_order_session_table.sql` for channel schema
  - [ ] Add `V1__create_member_table.sql` for core schema
  - [ ] Add repeatable seed migration for local/test bootstrap accounts
- [ ] Add internal boundary scaffold filters (AC: 4)
  - [ ] Add `InternalSecretFilter` in corebank service on `/internal/**`
  - [ ] Add `FepInternalSecretFilter` in fep service on `/fep-internal/**`
  - [ ] Externalize secrets with env variables and safe defaults for local
- [ ] Add common error envelope baseline (AC: 5)
  - [ ] Define/confirm shared API error schema in common module
  - [ ] Ensure initial exception handling returns normalized contract in channel/corebank/fep-gateway/fep-simulator
- [ ] Add smoke verification commands for Day 1 handoff (AC: 1, 2, 3, 4)
  - [ ] Build: `./gradlew build`
  - [ ] Bring-up: `docker compose up`
  - [ ] Health checks for all four backend services

Dev Notes

Developer Context Section

- Epic objective: establish non-negotiable baseline for all subsequent stories in Epic 0-10.
- This story is the root dependency for Stories 0.2, 0.3, and 0.4.
- Do not add feature logic here; only platform scaffolding, contracts, and runtime wiring.

Technical Requirements

- Runtime and topology:
  - Java 21, Spring Boot 3.x baseline.
  - Four deployable services with compose health checks.
  - Cold start target: first API response within 120 seconds after `docker compose up` (Vault + vault-init baseline).
- Data/platform:
  - MySQL InnoDB + Redis required from Day 1.
  - Flyway validate-on-migrate behavior must fail fast on migration mismatch.
- Security baseline:
  - Internal boundary secret filters for service-to-service endpoints.
  - Cookie/security hardening is further expanded in later epics, but scaffold must exist now.

Architecture Compliance

- Follow package and module conventions from architecture doc:
  - Package naming: `com.fix.{service}.{module}.{layer}`.
  - Module boundaries must align with ownership and compose network boundaries.
- Keep `core-common` pure Java.
- Avoid cross-schema ownership leakage (channel schema migration in channel service, core schema migration in corebank service).

Library / Framework Requirements

- Backend baseline to use now:
  - Java 21
  - Spring Boot `3.4.x` line (project architecture baseline)
  - Gradle multi-module build
  - Flyway for schema migration
- Latest ecosystem snapshot (2026-02-25) to avoid outdated choices:
  - Spring Boot latest stable: `4.0.3`; latest in 3.4 line: `3.4.13`; latest in 3.5 line: `3.5.11`
  - Gradle current release: `9.3.1`
- Guardrail:
  - Keep this story on architecture-pinned 3.4 line unless architecture document is explicitly updated; do not silently jump major framework lines in foundation story.

File Structure Requirements

- Expected touched areas:
  - `BE/settings.gradle*`
  - `BE/core-common/**`
  - `BE/testing-support/**`
  - `BE/channel-service/**`
  - `BE/corebank-service/**`
  - `BE/fep-gateway/**`
  - `BE/fep-simulator/**`
  - `/Users/yeongjae/fixyz/docker-compose.yml`
  - `/Users/yeongjae/fixyz/docker-compose.override.yml`
  - `/Users/yeongjae/fixyz/.env.example`
- Do not place shared constants in service modules when they belong to `core-common`.

Testing Requirements

- Minimum checks for story completion:
  - `./gradlew build` passes from clean checkout.
  - Health endpoints return `UP` for all four backend services after compose startup.
  - Filter boundary check: internal endpoints reject missing secret header.
  - Flyway migrations apply successfully for both channel/core schemas.
- Regression guard:
  - Empty baseline integration test compiles with Testcontainers dependencies available via `testing-support`.

Latest Tech Information

- Latest versions researched to prevent stale setup decisions:
  - Spring Boot metadata: latest stable `4.0.3`, with `3.4.13` as latest patch in the architecture-aligned minor line.
  - Gradle current: `9.3.1`.
- Implementation decision for this story:
  - Stay on architecture-pinned Spring Boot 3.4.x for consistency.
  - Use latest patch within selected major/minor where compatible.

Project Context Reference

- `project-context.md` file was not found in repository scan (`**/project-context.md`).
- Use planning + implementation artifacts as primary context sources for this story.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 0, Story 0.1)
- `_bmad-output/implementation-artifacts/epic-0-project-foundation.md` (Story 0.1 detailed acceptance criteria)
- `_bmad-output/planning-artifacts/architecture.md` (module boundaries, compose, security filters, Day 1 scaffold)
- `_bmad-output/planning-artifacts/prd.md` (FR-41, NFR-P3, NFR-S4)
- Spring Boot metadata: https://repo1.maven.org/maven2/org/springframework/boot/spring-boot/maven-metadata.xml
- Gradle current version API: https://services.gradle.org/versions/current

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Story generated from create-story workflow instructions and Epic 0 artifact synthesis.

Completion Notes List

- Story prepared with architecture and operations guardrails.
- Framework-version guidance included with stability constraints.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/0-1-be-core-platform-baseline.md","bmad","epic-0","story-0-1","lane-be","bmad-status-ready-for-dev","FIX-16"
"Story 0.2: BE Test and CI Foundation","Story","Story 0.2: BE Test and CI Foundation

Status: ready-for-dev

Story

As a platform engineer,
I want reproducible test and CI baselines,
so that feature teams can ship with deterministic validation.

Acceptance Criteria

- Given Testcontainers base classes, when integration tests execute, then MySQL/Redis test resources spin up deterministically.
- Given WireMock dependency policy, when contract test stubs are compiled, then test modules resolve all required classes.
- Given CI split workflow design, when push/PR occurs, then service-scoped pipelines execute independently.
- Given failed quality checks, when pipeline runs, then merge is blocked by status checks.

Tasks / Subtasks

- [ ] Establish shared test foundation in `testing-support` (AC: 1, 2)
  - [ ] Provide reusable MySQL and Redis Testcontainers base support
  - [ ] Expose Testcontainers/WireMock classes with scopes that downstream test modules can resolve
  - [ ] Document local reuse behavior vs CI isolated behavior
- [ ] Add CI workflow separation by service lane (AC: 3)
  - [ ] Add/verify backend scoped workflows for channel/corebank/fep-gateway/fep-simulator
  - [ ] Keep workflow commands deterministic and minimal
- [ ] Enforce quality gate behavior on PR (AC: 4)
  - [ ] Ensure failing test/lint/build status blocks merge to main
  - [ ] Ensure CI status checks are explicit branch protection targets
- [ ] Add baseline verification scripts/docs (AC: 1, 3, 4)
  - [ ] Command snippets for local fast validation
  - [ ] CI troubleshooting notes for containerized tests

Dev Notes

Developer Context Section

- Dependency: Story 0.1 must already define module skeleton and compose baseline.
- This story should not duplicate FE scaffold responsibilities from Story 0.3.
- Canonical split guardrail:
  - Story 0.2 = BE Test/CI foundation only.
  - Story 0.3 = FE scaffold only.

Technical Requirements

- Integration tests must use real MySQL/Redis semantics through Testcontainers.
- CI must run lane-specific pipelines so failures localize quickly.
- Coverage/quality checks should fail fast and block merges on red states.
- Keep Testcontainers behavior predictable:
  - local can leverage reuse optimization
  - CI must assume fresh isolated environment per job

Architecture Compliance

- Respect test layering guidance:
  - heavy integration in service modules
  - shared utility/container scaffolding in `testing-support`
- Maintain dependency direction and avoid coupling production code to test utilities.
- For FEP-related contract behavior, prefer standardized WireMock patterns to avoid divergent test setup.

Library / Framework Requirements

- Latest ecosystem snapshot (2026-02-25):
  - Testcontainers Java latest stable: `2.0.3`
  - WireMock standalone latest stable: `3.13.2` (4.x line is beta)
- Guardrails:
  - Avoid adopting prerelease/beta test stack in this foundation story.
  - Keep test stack versions explicit and centralized to prevent module drift.

File Structure Requirements

- Expected touched areas:
  - `BE/testing-support/**`
  - `BE/*-service/src/test/**`
  - `/Users/yeongjae/fixyz/.github/workflows/**`
  - `/Users/yeongjae/fixyz/README.md` (quality gate and local test runbook updates, if needed)
- Do not implement application features in this story; CI/test infrastructure only.

Testing Requirements

- Minimum checks for story completion:
  - Shared test base compiles from consuming service modules.
  - At least one integration test per lane can boot required containers.
  - CI workflows run independently and fail correctly on broken checks.
  - Branch protection-compatible status checks are produced.

Previous Story Intelligence

- From Story 0.1 context:
  - Module boundaries and compose contracts are the baseline; do not rework them in 0.2.
  - Internal boundary filter scaffold already exists; this story should only validate/test behavior, not redesign it.
  - Keep Day 1 startup success (`docker compose up`, health UP) untouched.

Git Intelligence Summary

- Recent commits indicate documentation-heavy and submodule setup activity (`BE`, `FE`, `MOB` linked as submodules).
- Actionable implication:
  - Keep test/CI changes scoped and traceable in dedicated files.
  - Avoid broad structural edits unrelated to CI foundation to reduce merge churn.

Latest Tech Information

- Version checks performed to avoid stale CI/tooling assumptions:
  - Testcontainers: `2.0.3`
  - WireMock standalone: `3.13.2`
- Recommendation:
  - Use stable lines only for CI baseline.
  - Revisit major upgrades after foundational epics stabilize.

Project Context Reference

- `project-context.md` was not found.
- Rely on architecture + Epic 0 implementation artifact and current repo structure.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 0, Story 0.2)
- `_bmad-output/implementation-artifacts/epic-0-project-foundation.md` (Story 0.2 detail variant)
- `_bmad-output/planning-artifacts/architecture.md` (testing-support scope, CI patterns, WireMock guidance)
- `_bmad-output/planning-artifacts/prd.md` (CI and quality NFR coverage context)
- Testcontainers metadata: https://repo1.maven.org/maven2/org/testcontainers/testcontainers/maven-metadata.xml
- WireMock metadata: https://repo1.maven.org/maven2/org/wiremock/wiremock-standalone/maven-metadata.xml

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Story generated from create-story workflow instructions and Epic 0 artifact synthesis.

Completion Notes List

- Previous-story and git intelligence added for implementation guardrails.
- Version-stability rules added to prevent premature beta adoption.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/0-2-be-test-ci-foundation.md","bmad","epic-0","story-0-2","lane-be","bmad-status-ready-for-dev","FIX-16"
"Story 0.3: FE Frontend Foundation Scaffold","Story","Story 0.3: FE Frontend Foundation Scaffold

Status: ready-for-dev

Story

As a frontend engineer,
I want a standardized web scaffold and API client,
so that product UI features can be implemented consistently.

Acceptance Criteria

- Given a Vite + TypeScript scaffold, when local dev server runs, then build and HMR work without runtime error.
- Given API base URL configuration, when client requests backend health endpoint, then call succeeds via configured proxy/base URL.
- Given path alias convention, when imports use alias paths, then compile and runtime resolution both succeed.
- Given shared error interceptor policy, when backend returns standard error schema, then web layer parses and displays normalized message.

Tasks / Subtasks

- [ ] Scaffold FE app baseline with modern React + TS stack (AC: 1)
  - [ ] Initialize/verify Vite React TypeScript scaffold in FE lane
  - [ ] Ensure local dev boot command is deterministic
  - [ ] Verify HMR and production build both succeed
- [ ] Implement API client baseline with environment-aware config (AC: 2)
  - [ ] Single axios client module with base URL env wiring
  - [ ] Development proxy routing to channel service
  - [ ] Health endpoint smoke check from UI layer
- [ ] Implement alias conventions and path safety (AC: 3)
  - [ ] Configure alias consistently in Vite + tsconfig
  - [ ] Ensure runtime and typechecker resolve same aliases
- [ ] Implement normalized error handling contract (AC: 4)
  - [ ] Add response interceptor for standard backend error schema
  - [ ] Map transport and contract errors to consistent UI-safe messages

Dev Notes

Developer Context Section

- Dependency: Story 0.1 baseline infrastructure must exist first.
- Scope boundary:
  - This story covers FE scaffold and web API client baseline only.
  - Keep business-domain UI features out of scope.
- FE is a separate submodule; avoid editing BE/MOB lanes except contract docs if required.

Technical Requirements

- Vite dev server must connect to backend via proxy/baseURL strategy.
- Standardized error envelope from backend must be decoded in one shared client interceptor.
- Alias strategy must stay single-source-of-truth between compiler and bundler.
- Keep foundation simple and auditable for demo/portfolio usage.

Architecture Compliance

- Architecture baseline indicates React + Vite + TypeScript with pnpm and unified axios client approach.
- Preserve compatibility with session/cookie architecture and same-origin/deployed cross-origin modes.
- Respect repo lane ownership: FE files under `FE/` only for implementation.

Library / Framework Requirements

- Latest ecosystem snapshot (2026-02-25):
  - React: `19.2.4`
  - Vite: `7.3.1`
  - TypeScript: `5.9.3`
  - pnpm: `10.30.2`
- Guardrail:
  - Architecture artifact references Vite 6/React 19 baseline; upgrades should stay within compatibility matrix and not block story delivery.

File Structure Requirements

- Expected touched areas:
  - `FE/package.json`
  - `FE/vite.config.*`
  - `FE/tsconfig*.json`
  - `FE/src/lib/axios.*`
  - `FE/src/types/**` (if error contract types centralized)
  - `FE/.env.example` or equivalent env docs
- Keep API client as single shared source; do not duplicate per-feature clients in foundation story.

Testing Requirements

- Minimum checks for story completion:
  - FE build passes (`pnpm build` or equivalent in FE lane).
  - Dev server starts cleanly and supports HMR.
  - Health API call succeeds via configured proxy/base URL.
  - Alias imports resolve at compile and runtime.
  - Error interceptor maps standardized backend errors consistently.

Previous Story Intelligence

- From Story 0.2 context:
  - CI lane separation is expected; keep FE CI signal independent from backend jobs.
  - Reuse established quality-gate mindset; avoid one-off local scripts with no CI symbolName.

Git Intelligence Summary

- Recent git history added FE/MOB submodules and documentation artifacts.
- Actionable implication:
  - Keep FE scaffold changes concentrated in FE submodule paths.
  - Prefer minimal, reviewable commits tied to explicit scaffold checkpoints.

Latest Tech Information

- Version checks performed for frontend foundations:
  - React `19.2.4`, Vite `7.3.1`, TypeScript `5.9.3`, pnpm `10.30.2`.
- Implementation strategy:
  - Use stable latest compatible versions for new scaffold unless architecture pinning requires a narrower band.

Project Context Reference

- `project-context.md` was not found.
- UX and architecture artifacts provide sufficient FE foundation guidance for this story.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 0, Story 0.3)
- `_bmad-output/planning-artifacts/architecture.md` (Frontend stack, proxy, package/tooling guidance)
- `_bmad-output/planning-artifacts/ux-design-specification.md` (routing and client-side UX contract constraints)
- `https://registry.npmjs.org/react` (dist-tags latest)
- `https://registry.npmjs.org/vite` (dist-tags latest)
- `https://registry.npmjs.org/typescript` (dist-tags latest)
- `https://registry.npmjs.org/pnpm` (dist-tags latest)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Story generated from create-story workflow instructions and Epic 0 artifact synthesis.

Completion Notes List

- FE foundation constraints split from BE CI foundation to prevent overlap.
- Version guidance added with compatibility guardrails.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/0-3-fe-frontend-foundation-scaffold.md","bmad","epic-0","story-0-3","lane-fe","bmad-status-ready-for-dev","FIX-16"
"Story 0.4: MOB Mobile Foundation Scaffold","Story","Story 0.4: MOB Mobile Foundation Scaffold

Status: ready-for-dev

Story

As a mobile engineer,
I want a standardized mobile scaffold and API layer,
so that mobile features follow the same contract and architecture.

Acceptance Criteria

- Given a mobile project scaffold, when the project is built and launched, then baseline app runs on target simulator/device.
- Given env-based API config, when mobile calls backend health endpoint, then request succeeds against host matrix (`Android emulator=http://10.0.2.2:8080`, `iOS simulator=http://localhost:8080`, `physical device=http://<LAN_IP>:8080`) with `GET /actuator/health` HTTP 200 within 5s.
- Given a common network module, when API errors occur, then mobile receives parsed standardized error payload.
- Given server-side cookie session policy, when session is issued, then mobile persists no raw credentials/password/OTP in app storage and uses OS-approved secure storage controls for any sensitive client-side secret material.
- Given cookie-session + CSRF contract for state-changing API calls, when mobile sends non-GET request, then client includes credentials and `X-XSRF-TOKEN` header derived from `XSRF-TOKEN` cookie (Double Submit Cookie).

Tasks / Subtasks

- [ ] Establish mobile project baseline scaffold (AC: 1)
  - [ ] Confirm/create mobile app skeleton in MOB lane
  - [ ] Verify simulator/emulator boot on at least one target platform
- [ ] Implement environment-based API configuration (AC: 2)
  - [ ] Support local/dev host overrides for emulator and physical device scenarios
  - [ ] Add health endpoint connectivity smoke path
  - [ ] Define cookie/session transport contract in network layer (`withCredentials`/cookie jar behavior, domain policy per env)
- [ ] Implement shared network layer with error normalization (AC: 3)
  - [ ] Centralize HTTP client setup and response handling
  - [ ] Parse backend standard error envelope into app-level error model
- [ ] Implement secure session persistence policy (AC: 4)
  - [ ] Fix the auth storage contract: cookie-session is canonical for Epic 0 (no local password/token persistence)
  - [ ] Use platform secure storage wrappers (iOS Keychain, Android Keystore-backed storage) for any sensitive local secret
  - [ ] Block plain AsyncStorage/unencrypted storage for secrets by lint/review rule
  - [ ] Keep storage strategy aligned with backend session/cookie model and PRD NFR-S1/NFR-S2
- [ ] Implement CSRF handling contract for cookie-session mode (AC: 5)
  - [ ] Add `XSRF-TOKEN` capture and `X-XSRF-TOKEN` injection in shared network module for POST/PUT/PATCH/DELETE
  - [ ] Ensure CSRF header injection is skipped for safe methods (GET/HEAD/OPTIONS)

Dev Notes

Developer Context Section

- Dependency: Story 0.1 foundational backend runtime must be available.
- Mobile lane is currently represented as a dedicated repository/submodule; keep changes isolated to MOB scope.
- Scope is scaffold + network/security baseline only; no feature screens required in this story.

Technical Requirements

- Mobile app must boot reliably in simulator/emulator with deterministic setup.
- API base URL handling must cover local development realities (host mapping and environment switching).
- Shared network module is mandatory to avoid per-feature HTTP divergence.
- Session-related sensitive data must use platform-secure persistence primitives.
- Financial-sector baseline policy for this story:
  - Do not persist password/OTP/session identifiers in plain client storage.
  - Use device-bound secure storage primitives (Keychain/Keystore-backed) for sensitive secrets.
  - Keep server-issued session controls as primary (HttpOnly/Secure cookie policy remains server-side authority).
- Sensitive data class contract (must be explicit in implementation docs):
  - `FORBIDDEN_PERSISTENCE`: password, OTP, session cookie raw value, CSRF token raw value.
  - `CONDITIONAL_SECURE_STORAGE_ONLY`: device-bound key material, refresh bootstrap secret (if introduced later).
  - `ALLOWED_NON_SENSITIVE`: API host config, feature flags, UX preference state.

Architecture Compliance

- Align with cross-system contract principles from architecture/prd:
  - standardized API error schema
  - session/security constraints
  - observable and deterministic behavior in dev environment
- Keep implementation choices compatible with FE/BE contract conventions to reduce cross-client divergence later.

Library / Framework Requirements

- Latest ecosystem snapshot (2026-02-25):
  - React Native latest stable tag: `0.84.0`
  - React latest stable tag: `19.2.4`
- Guardrail:
  - Follow the mobile framework's supported React pairing for the chosen RN version.
  - Prefer stable secure-storage libraries recommended by the selected mobile stack; avoid beta dependencies in foundation phase.

File Structure Requirements

- Expected touched areas:
  - `MOB/` project scaffold files
  - `MOB/src/network/**` (or equivalent shared client location)
  - `MOB/src/config/**` (environment/base URL config)
  - `MOB/src/security/**` (secure storage wrapper)
- Keep all mobile baseline logic in reusable modules; avoid duplicating network/auth glue in screen components.

Testing Requirements

- Minimum checks for story completion:
  - App boots on simulator/emulator without runtime crash.
  - Health API call succeeds with environment-configured host.
  - Standardized backend error payload is parsed into consistent app model.
  - Session persistence uses secure storage and survives app restart as required.

Previous Story Intelligence

- From Story 0.3 context:
  - Shared-client pattern is essential; enforce single network abstraction in mobile too.
  - Keep configuration centralized (base URL/env) and avoid per-feature drift.

Git Intelligence Summary

- Git history shows MOB submodule onboarding and artifact-first planning cadence.
- Actionable implication:
  - Keep mobile foundation changes sharply scoped and documented because MOB lane is newly integrated in repo topology.

Latest Tech Information

- Mobile stack version checks:
  - React Native `0.84.0`
  - React `19.2.4`
- Implementation strategy:
  - Choose stable RN baseline and preserve compatibility matrix with React.
  - Use secure-storage approach that is production-safe from day one.

Project Context Reference

- `project-context.md` was not found.
- Mobile foundation decisions are based on Epic 0 story contract + architecture/prd cross-system constraints.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 0, Story 0.4)
- `_bmad-output/planning-artifacts/architecture.md` (cross-system contract and security baseline)
- `_bmad-output/planning-artifacts/prd.md` (session/security and platform requirements)
- `https://registry.npmjs.org/react-native` (dist-tags latest)
- `https://registry.npmjs.org/react` (dist-tags latest)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Story generated from create-story workflow instructions and Epic 0 artifact synthesis.

Completion Notes List

- Mobile baseline guidance includes secure storage and contract normalization guardrails.
- Scope tightly constrained to scaffold/infrastructure setup.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/0-4-mob-mobile-foundation-scaffold.md","bmad","epic-0","story-0-4","lane-mob","bmad-status-ready-for-dev","FIX-16"
"Story 0.5: Collaboration Webhook Notifications (MatterMost + Jira + GitHub)","Story","Story 0.5: Collaboration Webhook Notifications (MatterMost + Jira + GitHub)

Status: ready-for-dev

Story

As a delivery team,
I want Jira and GitHub webhook events delivered to MatterMost,
so that release/quality state is visible in real time without manual polling.

Acceptance Criteria

- Given GitHub webhook events (`pull_request`, `workflow_run`), when GitHub Actions workflow posts to MatterMost incoming webhook, then MatterMost receives standardized notifications with repository, actor, link, and result.
- Given Jira webhook events for issue lifecycle transitions, when Jira Automation rule sends transition event to MatterMost webhook, then MatterMost receives issue key, summary, previous/new status, and assignee context.
- Given webhook secrets and integration endpoints, when runtime configuration is applied, then credentials are managed only via GitHub Secrets and Jira secured webhook settings (no hardcoding).
- Given duplicate delivery or retry from source systems, when the dedupe key `source + source_project + target_channel + event_type + entity_id + normalized_target_status + normalized_actor` (`null`/missing -> `_`) is observed again within a 10-minute suppression window, then duplicated user-visible posts are suppressed.
- Given direct integration architecture (no central relay), when dedupe state is persisted, then source-specific dedupe contract is explicit and auditable (`GitHub`: Actions cache key `mm-dedupe-{dedupe_hash}-{window_bucket_10m}` where `window_bucket_10m=floor(event_epoch/600)`; `Jira`: entity/property `mm_last_hash` + `mm_last_ts` with 10-minute timestamp comparison).
- Given outbound posting failure to MatterMost, when network timeout or non-2xx response occurs, then source retry policy executes with bounded retries (`max_attempts=3`), source-specific backoff contract (`GitHub`: `2s`,`5s` + jitter `±20%`; `Jira`: fixed `2s`,`5s` without jitter due platform limits), per-source+per-entity ordering guard, and final failure visibility in run/audit logs.
- Given reliability validation runbook execution, when duplicate and failure scenarios are replayed, then evidence artifacts are indexed under `docs/ops/webhook-validation/<YYYYMMDD>/` with reproducible naming and enforced retention configuration (`>=90 days`).

Tasks / Subtasks

- [ ] Implement GitHub Actions -> MatterMost notification workflow (AC: 1)
  - [ ] Support PR lifecycle and workflow result event triggers
  - [ ] Normalize message template (repo, actor, event, URL, result)
- [ ] Implement Jira Automation -> MatterMost notification rule set (AC: 2)
  - [ ] Support Story/Epic transition events
  - [ ] Normalize message template (issue key, summary, status change, assignee)
- [ ] Implement secure configuration management for webhook integration (AC: 3)
  - [ ] Manage webhook URL/token only via GitHub Secrets and Jira secured settings
  - [ ] Prevent sensitive token/URL leaks in logs
- [ ] Implement idempotency and anti-spam controls (AC: 4)
  - [ ] Implement dedupe key normalization: `source + source_project + target_channel + event_type + entity_id + normalized_target_status + normalized_actor` (`null`/missing -> `_`)
  - [ ] Prefer source event unique id (`delivery_id`/equivalent) when available; fallback to normalized hash key
  - [ ] Set suppression window to 10 minutes per source (GitHub/Jira) and document rationale
  - [ ] Suppress duplicate visible posts while keeping audit trace
- [ ] Define source-specific dedupe state contract (AC: 5)
  - [ ] GitHub: document cache-key contract `mm-dedupe-{dedupe_hash}-{window_bucket_10m}` and bucket computation rule (`floor(event_epoch/600)`) for 10-minute suppression
  - [ ] Jira: document entity/property-based dedupe state and 10-minute timestamp comparison rule for automation
  - [ ] Ensure dedupe state contract is auditable from workflow/audit logs
- [ ] Implement source-level retry/observability for posting failures (AC: 6)
  - [ ] Configure bounded retries (`max_attempts=3`) with exponential backoff (`2s`, `5s`) and jitter (`±20%`)
  - [ ] Define per-source+per-entity ordering guard (cross-source total ordering is out of scope)
  - [ ] Configure Jira automation failure visibility and audit trail with explicit platform-limited retry semantics
- [ ] Add validation runbook for GitHub/Jira flows, duplicate suppression, and failure recovery (AC: 7)
  - [ ] Include replay scenarios: duplicate webhook event, timeout, 429/5xx response, webhook URL misconfiguration
  - [ ] Save artifacts in `docs/ops/webhook-validation/<YYYYMMDD>/` using fixed naming (`github-*.log`, `jira-*.json`, `payload-*.json`)
  - [ ] Configure artifact retention enforcement (`retention-days: 90` for GitHub artifacts, Jira automation audit/export retention policy) and document owner

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 0 (`0.1`~`0.5`).
- Depends on Story 0.2 (CI foundation and quality-gate context).
- Scope is collaboration visibility automation only; no product-domain feature logic.
- Approach decision: Option 1 finalized (`GitHub Actions + Jira Automation` direct delivery to MatterMost), no central relay service in this story.

Technical Requirements

- Event sources:
  - GitHub webhook events via GitHub Actions: PR lifecycle + workflow result.
  - Jira webhook events via Jira Automation: issue transition for Story/Epic tracking.
- Delivery:
  - MatterMost message format must be standardized and link-rich.
- Reliability:
  - Source-side dedupe state contract and retry policy on post failures.
  - Retry policy must include bounded attempts and per-source+per-entity ordering guard; jitter is GitHub-only and Jira uses fixed delays due platform limits.
- Security:
  - Secrets only in GitHub Secrets and Jira secured webhook configuration, zero hardcoded credentials.

Architecture Compliance

- Keep integration isolated to CI/ops/collaboration boundary.
- Do not introduce a new relay microservice or BE domain coupling in this story.
- Keep logs structured and scrubbed for sensitive values.

File Structure Requirements

- Expected touched areas:
  - `.github/workflows/**` (GitHub -> MatterMost notification workflow)
  - Jira automation rule configuration artifacts/export notes
  - `docs/**` or `README.md` for runbook/secret setup

Testing Requirements

- Required checks:
  - GitHub PR/CI events map to expected MatterMost payload format.
  - Jira status transition events map to expected MatterMost payload format.
  - Duplicate delivery does not produce duplicate user-visible posts under configured guard window.
  - Post failure path is visible in GitHub/Jira run/audit logs with retry evidence.
  - Secret values are never printed in logs.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify `story_key <-> filename <-> sprint-status key` are identical.
- Security gate:
  - Validate no webhook secret/token leakage in logs or committed files.
- Idempotency gate:
  - Validate duplicate deliveries are suppressed via source-side guard conditions.
- Reliability gate:
  - Validate source workflow/automation retry behavior and failure observability under simulated outages.
- Evidence gate:
  - Attach event replay logs/tests for GitHub, Jira, duplicate, and failure scenarios.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Collaboration webhook integration story prepared with delivery, security, and reliability guardrails.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 0, Story 0.5)
- `_bmad-output/implementation-artifacts/0-2-be-test-ci-foundation.md`
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Story generated from canonical Epic 0 update and party-mode review criteria.

Completion Notes List

- Added webhook security, idempotency, and retry/observability controls as explicit gates.
- Locked implementation decision to Option 1 (direct tool integration, no central relay).

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/0-5-collaboration-webhook-notifications.md","bmad","epic-0","story-0-5","lane-mixed","bmad-status-ready-for-dev","FIX-16"
"Story 1.1: BE Registration and Login Session","Story","Story 1.1: BE Registration and Login Session

Status: ready-for-dev

Story

As a new or returning user,
I want to register and log in with secure session issuance,
so that I can access protected features safely.

Acceptance Criteria

- Given valid registration payload, when sign-up is requested, then member is created with default role and secure password hash.
- Given valid login credentials, when authentication succeeds, then Redis-backed session cookie is issued with secure attributes.
- Given duplicate login from the same account, when a second session is established, then previous session is invalidated by policy.
- Given invalid credentials, when login fails, then normalized authentication error is returned.

Tasks / Subtasks

- [ ] Implement registration endpoint and member creation policy (AC: 1)
  - [ ] Enforce role defaulting and password hashing policy
  - [ ] Return normalized success contract for register result
- [ ] Implement login endpoint with Spring Session Redis issuance (AC: 2)
  - [ ] Issue `JSESSIONID` with secure cookie attributes
  - [ ] Store and refresh authenticated session state in Redis
- [ ] Enforce single active session policy per account (AC: 3)
  - [ ] Expire prior active session on re-login
  - [ ] Return deterministic behavior for old/new session usage
- [ ] Normalize authentication error responses (AC: 4)
  - [ ] Unify invalid credentials/non-existent account response semantics
  - [ ] Ensure consistent global error envelope
- [ ] Add integration coverage for register/login/session baseline (AC: 1, 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 1 (`1.1`~`1.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md` has a different numbering/scope (`1.1`~`1.9`); use it only for technical constraints, not story ID mapping.

- Epic 1 foundation story for all subsequent auth stories.
- Canonical tracking for this planning set is `epics.md` Story 1.1.
- Additional detailed artifact exists (`epic-1-user-authentication-and-account-access.md`) and should be treated as supplemental constraints, not replacement of current story numbering.

Technical Requirements

- Session model:
  - Spring Session Redis with sliding TTL semantics.
  - Secure cookie attributes (`HttpOnly`, `Secure`, `SameSite`) must follow profile policy.
- Auth policy:
  - Strong password hashing (BCrypt, architecture baseline indicates cost-hardening path).
  - Login failure responses must avoid account enumeration leaks.
- Session invalidation:
  - New login should invalidate prior session per account policy.

Architecture Compliance

- Keep auth/session handling in channel service auth/security layers.
- Preserve standardized error envelope and correlation-id propagation patterns.
- Use architecture-defined Redis key and session conventions; do not reintroduce JWT refresh token flows (deprecated in architecture decisions).

Library / Framework Requirements

- Latest auth-related ecosystem snapshot (2026-02-25):
  - Spring Security config: `7.0.3`
  - Spring Session Redis: `4.0.2`
  - Spring Boot latest in architecture line: `3.4.13`
- Guardrail:
  - Follow architecture-pinned Spring Boot/Security compatibility matrix for foundation story.
  - Avoid major auth model changes in this story.

File Structure Requirements

- Expected touched areas:
  - `BE/channel-service/src/main/**/auth/**`
  - `BE/channel-service/src/main/**/security/**`
  - `BE/channel-service/src/main/resources/application*.yml`
  - `BE/channel-service/src/test/**`
  - `BE/core-common/**` (only if shared error/auth constants required)
- Keep member/account domain ownership boundaries consistent with existing architecture.

Testing Requirements

- Required checks:
  - Register success, duplicate registration, validation failures.
  - Login success with secure session cookie issuance.
  - Invalid credentials return normalized auth error.
  - Re-login invalidates previous session deterministically.
  - Integration test runs against real Redis + MySQL containers.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify 'story_key <-> filename <-> sprint-status key' are identical before moving status from 'ready-for-dev' to 'in-progress'.
  - Reject implementation start if key mismatch is detected between canonical Epic 1 numbering (`epics.md`) and supplemental Epic artifact.
- FE/MOB session consistency gate:
  - Validate same behavior matrix for FE and MOB on: valid session, expired session, invalidated-by-new-login, logout-after-call, app/browser resume.
  - Validate same user-facing semantics for re-auth guidance and fallback handling (401 + session-expiry event paths).
- Lockout/rate-limit boundary gate:
  - Add boundary tests for `N-1`, `N`, `N+1` attempts (IP limit and account lockout separately).
  - Validate cooldown/reset behavior and ensure locked account remains denied even with correct credentials until admin unlock.
  - Validate security event persistence on lockout with correlation key for traceability.
- Quality risk severity gate:
  - Any P0/P1 defect in auth/session/security behavior blocks status transition to `review`.
  - Any accepted P2 defect must include issue ID, owner, and due date in QA evidence.
- Evidence gate for review handoff:
  - Attach automated test evidence for this story and impacted Epic 1 regression scenarios.
  - Attach negative-path replay result for `N-1`, `N`, `N+1` boundaries and session expiry paths.
  - Attach one correlation sample linking client-visible error to server-side security event/log.
- Party review resolution status (2026-02-25):
  - [ ] Scope alignment confirmed: lockout/rate-limit policy implementation is owned by Story 1.5; Story 1.1 only guarantees auth/session baseline compatibility.
  - [ ] Redis+MySQL integration evidence attached for register/login/session issuance path (including secure cookie attributes).
  - [ ] Duplicate-login invalidation evidence attached showing deterministic old-session denial and new-session success.
  - [ ] Invalid-credential normalization evidence attached with non-enumerating auth error semantics.

- Execution reference:
  - Run Epic 1 focused checklist: `_bmad-output/implementation-artifacts/epic-1-qa-reinforcement-checklist.md`.

Latest Tech Information

- Version references refreshed:
  - Spring Security `7.0.3`, Spring Session Data Redis `4.0.2`, Spring Boot `3.4.13` patch line.
- Implementation guidance:
  - Keep story implementation aligned with architecture-pinned stack and stable releases.

Project Context Reference

- `project-context.md` not found in repository scan.
- Context derived from planning/architecture/implementation artifacts.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Story 1.1)
- `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md`
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- https://repo1.maven.org/maven2/org/springframework/security/spring-security-config/maven-metadata.xml
- https://repo1.maven.org/maven2/org/springframework/session/spring-session-data-redis/maven-metadata.xml
- https://repo1.maven.org/maven2/org/springframework/boot/spring-boot/maven-metadata.xml

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated via create-story workflow instructions with Epic 1 artifact synthesis.

Completion Notes List

- Added session/security guardrails and deprecated-pattern exclusions.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/1-1-be-registration-login-session.md","bmad","epic-1","story-1-1","lane-be","bmad-status-ready-for-dev","FIX-17"
"Story 1.2: BE Logout, Profile, and Session Security","Story","Story 1.2: BE Logout, Profile, and Session Security

Status: ready-for-dev

Story

As an authenticated user,
I want to manage profile and logout safely,
so that account access remains under my control.

Acceptance Criteria

- Given valid authenticated session, when logout API is called, then session is deleted server-side and cookie is expired.
- Given profile/password update request, when validation passes, then account profile is updated with audit trail.
- Given expired or invalidated session, when protected endpoint is called, then API returns authentication-required error.
- Given session timeout policy, when inactivity exceeds threshold, then session is treated as expired.

Tasks / Subtasks

- [ ] Implement explicit logout endpoint and session invalidation (AC: 1)
  - [ ] Invalidate server session and expire cookie immediately
  - [ ] Ensure subsequent request with old cookie is rejected
- [ ] Implement profile read/update and password update flow (AC: 2)
  - [ ] Apply validation and secure password-change flow
  - [ ] Persist audit trail entries for profile/security updates
- [ ] Enforce protected-route auth error normalization (AC: 3)
  - [ ] Ensure 401 behavior is deterministic for invalidated/expired sessions
- [ ] Enforce session timeout handling path (AC: 4)
  - [ ] Validate TTL-based expiry path and client-visible behavior contract
- [ ] Add integration tests for logout/profile/session expiry behavior (AC: 1, 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 1 (`1.1`~`1.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md` has a different numbering/scope (`1.1`~`1.9`); use it only for technical constraints, not story ID mapping.

- Depends on Story 1.1 auth/session issuance.
- This story owns account-control safety behavior (logout + profile/password + expiry semantics).
- Supplemental detailed artifact maps similar concerns under different split; keep this plan's Story 1.2 numbering as source of truth.

Technical Requirements

- Session invalidation must be immediate and observable on next protected request.
- Profile/password mutations require audit logging and validation guardrails.
- Session expiry behavior must align with security requirements and predictable UX redirect paths.
- Error responses must preserve standardized global format.

Architecture Compliance

- Keep auth/session logic within channel-service security/auth modules.
- Respect Spring Session Redis semantics; do not implement token blacklist patterns that architecture has already deprecated.
- Keep CSRF/session hardening aligned with architecture and login-flow decisions.

Library / Framework Requirements

- Latest references (2026-02-25):
  - Spring Security: `7.0.3`
  - Spring Session Redis: `4.0.2`
- Guardrail:
  - Maintain compatibility with architecture-pinned Spring Boot 3.4.x track.

File Structure Requirements

- Expected touched areas:
  - `BE/channel-service/src/main/**/auth/**`
  - `BE/channel-service/src/main/**/member/**`
  - `BE/channel-service/src/main/**/security/**`
  - `BE/channel-service/src/main/**/audit/**`
  - `BE/channel-service/src/test/**`
- Keep audit/event schema interactions consistent with existing event models.

Testing Requirements

- Required checks:
  - Logout invalidates session immediately and expires cookie.
  - Protected API with old/expired session yields auth-required error.
  - Profile/password update validation and success/failure cases.
  - Audit record assertions for privileged security mutations.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify 'story_key <-> filename <-> sprint-status key' are identical before moving status from 'ready-for-dev' to 'in-progress'.
  - Reject implementation start if key mismatch is detected between canonical Epic 1 numbering (`epics.md`) and supplemental Epic artifact.
- FE/MOB session consistency gate:
  - Validate same behavior matrix for FE and MOB on: valid session, expired session, invalidated-by-new-login, logout-after-call, app/browser resume.
  - Validate same user-facing semantics for re-auth guidance and fallback handling (401 + session-expiry event paths).
- Lockout/rate-limit boundary gate:
  - Add boundary tests for `N-1`, `N`, `N+1` attempts (IP limit and account lockout separately).
  - Validate cooldown/reset behavior and ensure locked account remains denied even with correct credentials until admin unlock.
  - Validate security event persistence on lockout with correlation key for traceability.
- Quality risk severity gate:
  - Any P0/P1 defect in auth/session/security behavior blocks status transition to `review`.
  - Any accepted P2 defect must include issue ID, owner, and due date in QA evidence.
- Evidence gate for review handoff:
  - Attach automated test evidence for this story and impacted Epic 1 regression scenarios.
  - Attach negative-path replay result for `N-1`, `N`, `N+1` boundaries and session expiry paths.
  - Attach one correlation sample linking client-visible error to server-side security event/log.
- Party review resolution status (2026-02-25):
  - [ ] Logout invalidation is atomic (server session delete + cookie expiry) and evidenced in one flow.
  - [ ] Old cookie replay after logout/expiry returns deterministic auth-required contract (401 path evidence attached).
  - [ ] Profile/password update validation evidence attached with required audit-trail persistence proof.
  - [ ] Session timeout path evidence attached for inactivity-expired behavior on protected endpoints.

- Execution reference:
  - Run Epic 1 focused checklist: `_bmad-output/implementation-artifacts/epic-1-qa-reinforcement-checklist.md`.

Previous Story Intelligence

- From Story 1.1:
  - Reuse existing auth/session primitives; do not duplicate login/session logic.
  - Preserve one-session policy semantics when implementing invalidation paths.

Git Intelligence Summary

- Recent repository history is artifact-first and module-structure-heavy.
- Keep changes isolated and traceable to auth/session security behavior to avoid cross-lane churn.

Latest Tech Information

- Auth/session version refresh included from official metadata.
- No prerelease adoption recommended for this story.

Project Context Reference

- `project-context.md` not found in repository scan.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Story 1.2)
- `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md`
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- https://repo1.maven.org/maven2/org/springframework/security/spring-security-config/maven-metadata.xml
- https://repo1.maven.org/maven2/org/springframework/session/spring-session-data-redis/maven-metadata.xml

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated via create-story workflow instructions with Epic 1 artifact synthesis.

Completion Notes List

- Added previous-story intelligence and session-expiry security guardrails.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/1-2-be-logout-profile-session-security.md","bmad","epic-1","story-1-2","lane-be","bmad-status-ready-for-dev","FIX-17"
"Story 1.3: FE Web Auth Flow","Story","Story 1.3: FE Web Auth Flow

Status: ready-for-dev

Story

As a web user,
I want intuitive login/register/private navigation,
so that authenticated routes behave predictably.

Acceptance Criteria

- Given login and register screens, when valid credentials are submitted, then user is navigated to protected area.
- Given unauthenticated access to private route, when route guard runs, then user is redirected to login.
- Given server-auth error, when response arrives, then standardized UX error message is shown.
- Given session expiration notification event, when web receives it, then user sees re-auth guidance.

Tasks / Subtasks

- [ ] Implement login/register screens and submission flow (AC: 1)
  - [ ] Integrate with auth APIs using shared client
  - [ ] Persist authenticated member state via approved global store pattern
- [ ] Implement private-route guard and navigation rules (AC: 2)
  - [ ] Redirect unauthenticated users to `/login`
  - [ ] Preserve predictable post-auth navigation behavior
- [ ] Implement standardized auth error UX (AC: 3)
  - [ ] Map backend auth error codes to user-facing messages
  - [ ] Prevent duplicate/conflicting error surfaces
- [ ] Implement session-expiry event handling and re-auth guidance (AC: 4)
  - [ ] Handle SSE/session expiry warning and 401 fallback paths
  - [ ] Ensure cleanup/reconnect strategy for event stream
- [ ] Add FE tests for route guard + auth error + expiry guidance (AC: 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 1 (`1.1`~`1.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md` has a different numbering/scope (`1.1`~`1.9`); use it only for technical constraints, not story ID mapping.

- Depends on Story 1.1 + 1.2 + 0.3.
- Focus is auth UX flow and guarded navigation, not order UX.
- Standardization across FE and MOB begins here and is completed in Story 1.6.

Technical Requirements

- Route protection:
  - Private routes must block unauthenticated access deterministically.
- Auth state:
  - Use architecture-approved global auth state pattern (Zustand-based flow indicated in architecture artifact).
- Error UX:
  - Use consistent auth error mapping and user guidance.
- Session expiry:
  - Support expiry warning and re-auth route behavior with resilient fallback.

Architecture Compliance

- Keep FE auth behavior aligned with server session-cookie model.
- Do not rely on reading HttpOnly cookie directly in browser JS.
- Follow architecture notes on centralized interceptor and auth store responsibilities.

Library / Framework Requirements

- Latest FE auth ecosystem snapshot (2026-02-25):
  - `react-router-dom`: `7.13.1`
  - `zustand`: `5.0.11`
  - `react`: `19.2.4`
- Guardrail:
  - Preserve compatibility with existing FE scaffold and current lane package strategy.

File Structure Requirements

- Expected touched areas:
  - `FE/src/pages/Login*`
  - `FE/src/pages/Register*`
  - `FE/src/router/**` or `FE/src/App.*`
  - `FE/src/components/PrivateRoute*`
  - `FE/src/store/useAuthStore*`
  - `FE/src/lib/axios*`
  - `FE/src/test/**` or equivalent
- Keep auth flow logic centralized; avoid per-page duplicated guard logic.

Testing Requirements

- Required checks:
  - Valid login/register flow navigates correctly.
  - Unauthenticated private-route access redirects to login.
  - Auth errors render standardized UX messages.
  - Session-expiry warning/401 behavior triggers re-auth guidance.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify 'story_key <-> filename <-> sprint-status key' are identical before moving status from 'ready-for-dev' to 'in-progress'.
  - Reject implementation start if key mismatch is detected between canonical Epic 1 numbering (`epics.md`) and supplemental Epic artifact.
- FE/MOB session consistency gate:
  - Validate same behavior matrix for FE and MOB on: valid session, expired session, invalidated-by-new-login, logout-after-call, app/browser resume.
  - Validate same user-facing semantics for re-auth guidance and fallback handling (401 + session-expiry event paths).
- Lockout/rate-limit boundary gate:
  - Add boundary tests for `N-1`, `N`, `N+1` attempts (IP limit and account lockout separately).
  - Validate cooldown/reset behavior and ensure locked account remains denied even with correct credentials until admin unlock.
  - Validate security event persistence on lockout with correlation key for traceability.
- Quality risk severity gate:
  - Any P0/P1 defect in auth/session/security behavior blocks status transition to `review`.
  - Any accepted P2 defect must include issue ID, owner, and due date in QA evidence.
- Evidence gate for review handoff:
  - Attach automated test evidence for this story and impacted Epic 1 regression scenarios.
  - Attach negative-path replay result for `N-1`, `N`, `N+1` boundaries and session expiry paths.
  - Attach one correlation sample linking client-visible error to server-side security event/log.
- Party review resolution status (2026-02-25):
  - [ ] Private-route redirect loop prevention evidence attached (no infinite redirect/retry behavior).
  - [ ] Auth error mapping evidence attached showing single consistent UX surface per backend code.
  - [ ] Session-expiry event + 401 fallback evidence attached with deterministic re-auth guidance.
  - [ ] FE behavior parity evidence recorded against shared Epic 1 session behavior matrix.

- Execution reference:
  - Run Epic 1 focused checklist: `_bmad-output/implementation-artifacts/epic-1-qa-reinforcement-checklist.md`.

Previous Story Intelligence

- From Story 1.2:
  - Logout and expiry semantics are server-authoritative.
  - FE must consume these states, not reinterpret them with custom client-only policies.

Git Intelligence Summary

- FE lane is submodule-based and recently scaffolded.
- Keep auth-flow changes local to FE lane and avoid BE/MOB coupling in this story.

Latest Tech Information

- FE auth stack versions refreshed via npm dist-tags.
- No unstable package line required for this story.

Project Context Reference

- `project-context.md` not found in repository scan.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Story 1.3)
- `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md`
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/ux-design-specification.md`
- https://registry.npmjs.org/react-router-dom
- https://registry.npmjs.org/zustand
- https://registry.npmjs.org/react

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated via create-story workflow instructions with Epic 1 artifact synthesis.

Completion Notes List

- Added explicit FE auth-state and route-guard guardrails for implementation.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/1-3-fe-web-auth-flow.md","bmad","epic-1","story-1-3","lane-fe","bmad-status-ready-for-dev","FIX-17"
"Story 1.4: MOB Mobile Auth Flow","Story","Story 1.4: MOB Mobile Auth Flow

Status: ready-for-dev

Story

As a mobile user,
I want native auth flow parity with web,
so that account access rules stay consistent across clients.

Acceptance Criteria

- Given mobile login/register screens, when valid form is submitted, then user enters authenticated app stack.
- Given invalid or expired session, when protected API is called, then mobile routes user to re-auth flow.
- Given auth API validation error, when response is returned, then field-level or global message is shown.
- Given device app resume, when session state is checked, then stale sessions are rejected deterministically.

Tasks / Subtasks

- [ ] Implement mobile login/register flow parity with web contract (AC: 1)
  - [ ] Wire auth endpoints and navigation stack transitions
- [ ] Implement protected-route/session invalidation handling (AC: 2)
  - [ ] On auth-required response, route to re-auth flow deterministically
- [ ] Implement standardized mobile auth error UX (AC: 3)
  - [ ] Support field-level and global error surfaces by code type
- [ ] Implement app-resume session check behavior (AC: 4)
  - [ ] Revalidate session/auth state on resume and clear stale auth state
- [ ] Add mobile tests for auth stack transitions and stale-session handling

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 1 (`1.1`~`1.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md` has a different numbering/scope (`1.1`~`1.9`); use it only for technical constraints, not story ID mapping.

- Depends on Story 1.1, 1.2, and 0.4 mobile scaffold.
- Objective is parity with web auth semantics, not identical UI implementation.
- Keep mobile-specific lifecycle handling (background/resume) explicit.

Technical Requirements

- Session semantics must mirror server-auth model used by web.
- Re-auth flow must be deterministic for expired/invalid sessions.
- Mobile auth state should survive app lifecycle safely while honoring server invalidation.
- Error handling must align with shared backend auth code semantics.

Architecture Compliance

- Use centralized mobile network/auth layers from foundation scaffold.
- Keep secure storage and token/session handling policy compliant with mobile security baseline.
- Avoid custom auth branches that diverge from FE semantics unless required by platform lifecycle.

Library / Framework Requirements

- Latest mobile ecosystem snapshot (2026-02-25):
  - `react-native`: `0.84.0`
  - `react`: `19.2.4`
- Guardrail:
  - Keep React/RN compatibility aligned with selected RN release.

File Structure Requirements

- Expected touched areas:
  - `MOB/src/screens/auth/**`
  - `MOB/src/navigation/**`
  - `MOB/src/network/**`
  - `MOB/src/store/**`
  - `MOB/src/security/**`
- Avoid duplicating auth/session checks in multiple screen components.

Testing Requirements

- Required checks:
  - Login/register success transitions into authenticated app stack.
  - Expired/invalid session routes to re-auth.
  - Auth validation errors map to expected field/global messages.
  - App resume revalidates stale auth state reliably.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify 'story_key <-> filename <-> sprint-status key' are identical before moving status from 'ready-for-dev' to 'in-progress'.
  - Reject implementation start if key mismatch is detected between canonical Epic 1 numbering (`epics.md`) and supplemental Epic artifact.
- FE/MOB session consistency gate:
  - Validate same behavior matrix for FE and MOB on: valid session, expired session, invalidated-by-new-login, logout-after-call, app/browser resume.
  - Validate same user-facing semantics for re-auth guidance and fallback handling (401 + session-expiry event paths).
- Lockout/rate-limit boundary gate:
  - Add boundary tests for `N-1`, `N`, `N+1` attempts (IP limit and account lockout separately).
  - Validate cooldown/reset behavior and ensure locked account remains denied even with correct credentials until admin unlock.
  - Validate security event persistence on lockout with correlation key for traceability.
- Quality risk severity gate:
  - Any P0/P1 defect in auth/session/security behavior blocks status transition to `review`.
  - Any accepted P2 defect must include issue ID, owner, and due date in QA evidence.
- Evidence gate for review handoff:
  - Attach automated test evidence for this story and impacted Epic 1 regression scenarios.
  - Attach negative-path replay result for `N-1`, `N`, `N+1` boundaries and session expiry paths.
  - Attach one correlation sample linking client-visible error to server-side security event/log.
- Party review resolution status (2026-02-25):
  - [ ] App resume/background revalidation evidence attached for deterministic stale-session rejection.
  - [ ] Re-auth navigation evidence attached (no loop/back-stack corruption on auth-required response).
  - [ ] Field/global auth error rendering evidence attached and aligned with backend code semantics.
  - [ ] MOB behavior parity evidence recorded against FE baseline session matrix.

- Execution reference:
  - Run Epic 1 focused checklist: `_bmad-output/implementation-artifacts/epic-1-qa-reinforcement-checklist.md`.

Previous Story Intelligence

- From Story 1.3:
  - Preserve cross-client semantics for auth error and session expiry handling.
  - Keep differences limited to platform lifecycle and navigation mechanics.

Git Intelligence Summary

- MOB lane is recently integrated as submodule.
- Keep changes narrowly scoped and avoid cross-repo pattern drift.

Latest Tech Information

- RN/React versions refreshed via npm metadata.
- Use stable, compatible versions for auth foundation work.

Project Context Reference

- `project-context.md` not found in repository scan.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Story 1.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/planning-artifacts/ux-design-specification.md`
- https://registry.npmjs.org/react-native
- https://registry.npmjs.org/react

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated via create-story workflow instructions with Epic 1 artifact synthesis.

Completion Notes List

- Added lifecycle/session revalidation guardrails specific to mobile.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/1-4-mob-mobile-auth-flow.md","bmad","epic-1","story-1-4","lane-mob","bmad-status-ready-for-dev","FIX-17"
"Story 1.5: BE Auth Guardrails (Lockout and Rate Limit)","Story","Story 1.5: BE Auth Guardrails (Lockout and Rate Limit)

Status: ready-for-dev

Story

As a security system,
I want login abuse controls,
so that brute-force attempts are mitigated.

Acceptance Criteria

- Given repeated failed login attempts by IP, when threshold is exceeded, then login endpoint returns rate-limit error.
- Given repeated failed login attempts by account, when threshold is exceeded, then account transitions to locked state.
- Given locked account, when correct password is submitted, then login remains denied until admin unlock.
- Given lockout event, when recorded, then security event is persisted.

Tasks / Subtasks

- [ ] Implement IP-based login rate limiting (AC: 1)
  - [ ] Apply bounded threshold and cooldown policy at login boundary
  - [ ] Return consistent rate-limit error contract
- [ ] Implement account-based lockout transition logic (AC: 2)
  - [ ] Increment and evaluate failed-attempt counters
  - [ ] Persist lock state transition with deterministic threshold behavior
- [ ] Enforce locked-account denial regardless of credential correctness (AC: 3)
  - [ ] Ensure auth layer checks lock state before granting session
- [ ] Persist security lockout events for auditability (AC: 4)
  - [ ] Write structured security-event record on lockout and relevant auth abuse conditions
- [ ] Add integration + unit tests for thresholds, cooldown, and lock lifecycle

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 1 (`1.1`~`1.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md` has a different numbering/scope (`1.1`~`1.9`); use it only for technical constraints, not story ID mapping.

- Depends on Story 1.1 auth baseline.
- This story is the main security hardening layer for login abuse prevention.
- Outputs are prerequisites for cross-client auth error standardization in Story 1.6.

Technical Requirements

- Dual guardrails required:
  - IP-based request throttling.
  - Account-based lockout state transition.
- Locked-account denial must be enforced even with correct credentials.
- Security events must be stored separately or with security semantics that support longer retention and investigations.

Architecture Compliance

- Architecture indicates Bucket4j + Redis-backed rate limiting on selected endpoints.
- Respect global error envelope and security event taxonomy conventions.
- Keep auth guardrails in channel-service boundary and avoid service-layer duplication in clients.

Library / Framework Requirements

- Latest rate-limit/auth stack snapshot (2026-02-25):
  - Bucket4j jdk17 core: `8.16.1`
  - Spring Security: `7.0.3`
- Guardrail:
  - Use stable Bucket4j line and centralize policies via configuration where possible.

File Structure Requirements

- Expected touched areas:
  - `BE/channel-service/src/main/**/security/**`
  - `BE/channel-service/src/main/**/auth/**`
  - `BE/channel-service/src/main/**/audit/**` or `security-events/**`
  - `BE/channel-service/src/main/resources/application*.yml`
  - `BE/channel-service/src/test/**`
- Keep abuse-control policies in one place to avoid threshold mismatch.

Testing Requirements

- Required checks:
  - IP threshold reached -> rate-limit error.
  - Account threshold reached -> locked state transition.
  - Locked account denied even with correct password.
  - Security event persisted on lockout.
  - Counter reset/cooldown policy behaves as designed.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify 'story_key <-> filename <-> sprint-status key' are identical before moving status from 'ready-for-dev' to 'in-progress'.
  - Reject implementation start if key mismatch is detected between canonical Epic 1 numbering (`epics.md`) and supplemental Epic artifact.
- FE/MOB session consistency gate:
  - Validate same behavior matrix for FE and MOB on: valid session, expired session, invalidated-by-new-login, logout-after-call, app/browser resume.
  - Validate same user-facing semantics for re-auth guidance and fallback handling (401 + session-expiry event paths).
- Lockout/rate-limit boundary gate:
  - Add boundary tests for `N-1`, `N`, `N+1` attempts (IP limit and account lockout separately).
  - Validate cooldown/reset behavior and ensure locked account remains denied even with correct credentials until admin unlock.
  - Validate security event persistence on lockout with correlation key for traceability.
- Quality risk severity gate:
  - Any P0/P1 defect in auth/session/security behavior blocks status transition to `review`.
  - Any accepted P2 defect must include issue ID, owner, and due date in QA evidence.
- Evidence gate for review handoff:
  - Attach automated test evidence for this story and impacted Epic 1 regression scenarios.
  - Attach negative-path replay result for `N-1`, `N`, `N+1` boundaries and session expiry paths.
  - Attach one correlation sample linking client-visible error to server-side security event/log.
- Party review resolution status (2026-02-25):
  - [ ] IP and account controls validated independently with explicit `N-1` / `N` / `N+1` evidence.
  - [ ] Locked-account denial with correct password proven until explicit admin unlock.
  - [ ] Cooldown/reset behavior evidence attached for both IP rate-limit and account lock states.
  - [ ] Security event persistence evidence attached with correlation key traceability.

- Execution reference:
  - Run Epic 1 focused checklist: `_bmad-output/implementation-artifacts/epic-1-qa-reinforcement-checklist.md`.

Previous Story Intelligence

- From Story 1.4 (cross-client parity context):
  - Auth errors emitted here must be client-consumable and stable.
- From Story 1.2:
  - Session semantics already established; this story must harden pre-session auth path, not rework session model.

Git Intelligence Summary

- Repository cadence shows architecture-led decisions and strict lane boundaries.
- Keep auth hardening changes targeted and config-driven to reduce integration risk.

Latest Tech Information

- Bucket4j and Spring Security versions refreshed from official metadata sources.
- Avoid beta/preview dependencies for security controls.

Project Context Reference

- `project-context.md` not found in repository scan.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Story 1.5)
- `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md`
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- https://repo1.maven.org/maven2/com/bucket4j/bucket4j_jdk17-core/maven-metadata.xml
- https://repo1.maven.org/maven2/org/springframework/security/spring-security-config/maven-metadata.xml

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated via create-story workflow instructions with Epic 1 artifact synthesis.

Completion Notes List

- Added lockout/rate-limit dual-control implementation guardrails and test scope.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/1-5-be-auth-guardrails-lockout-rate-limit.md","bmad","epic-1","story-1-5","lane-be","bmad-status-ready-for-dev","FIX-17"
"Story 1.6: FE/MOB Auth Error Standardization","Story","Story 1.6: FE/MOB Auth Error Standardization

Status: ready-for-dev

Story

As a cross-client product team,
I want FE/MOB auth error handling standardized,
so that users receive consistent guidance regardless of client.

Acceptance Criteria

- Given identical backend auth code, when FE and MOB render message, then user-facing semantics are aligned.
- Given lockout/expired/rate-limit cases, when triggered, then both clients show recoverable next actions.
- Given untranslated or unknown code, when received, then fallback message and correlation id are surfaced.

Tasks / Subtasks

- [ ] Define shared auth error mapping contract for FE + MOB (AC: 1)
  - [ ] Create canonical code-to-message semantics table
  - [ ] Keep language/action consistency across clients
- [ ] Implement lockout/expired/rate-limit UX parity (AC: 2)
  - [ ] Ensure recoverable next steps are shown consistently
  - [ ] Align redirect/retry guidance between clients
- [ ] Implement unknown-code fallback with traceability (AC: 3)
  - [ ] Provide safe generic message
  - [ ] Surface correlation id for support diagnostics
- [ ] Add cross-client contract tests or snapshot assertions for parity

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 1 (`1.1`~`1.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md` has a different numbering/scope (`1.1`~`1.9`); use it only for technical constraints, not story ID mapping.

- Depends on Stories 1.3, 1.4, and 1.5.
- This story is a cross-client consistency pass, not a new auth feature.
- Outcome must reduce support ambiguity and improve incident triage quality.

Technical Requirements

- Error mapping must be centralized per client and source-controlled with explicit code coverage.
- Recoverability guidance is required for key auth failures (lockout/session-expired/rate-limit).
- Unknown-code fallback must be deterministic and include correlation key visibility.

Architecture Compliance

- Respect architecture error-envelope conventions and correlation-id propagation model.
- Do not create FE/MOB divergent interpretations for the same backend code.
- Keep UX behavior compatible with session-expiry and route-guard flows defined earlier.

Library / Framework Requirements

- Latest client-stack references (2026-02-25):
  - `react-router-dom`: `7.13.1`
  - `zustand`: `5.0.11`
  - `react-native`: `0.84.0`
- Guardrail:
  - Standardization should be framework-agnostic at contract level, framework-specific only at rendering/navigation layer.

File Structure Requirements

- Expected touched areas:
  - `FE/src/lib/errors*` or equivalent mapping module
  - `FE/src/lib/axios*` interceptors
  - `FE/src/components/Error*`
  - `MOB/src/network/errors*` or equivalent mapping module
  - `MOB/src/components/feedback/**`
  - Cross-client docs/spec artifact if maintained
- Avoid copy-paste drift by establishing one canonical mapping table per client lane sourced from shared contract.

Testing Requirements

- Required checks:
  - Same backend auth code -> same semantic message/action on FE and MOB.
  - Lockout/expired/rate-limit scenarios show expected next actions.
  - Unknown code fallback includes correlation id and non-breaking UX.
  - Regression tests prevent mapping divergence over time.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify 'story_key <-> filename <-> sprint-status key' are identical before moving status from 'ready-for-dev' to 'in-progress'.
  - Reject implementation start if key mismatch is detected between canonical Epic 1 numbering (`epics.md`) and supplemental Epic artifact.
- FE/MOB session consistency gate:
  - Validate same behavior matrix for FE and MOB on: valid session, expired session, invalidated-by-new-login, logout-after-call, app/browser resume.
  - Validate same user-facing semantics for re-auth guidance and fallback handling (401 + session-expiry event paths).
- Lockout/rate-limit boundary gate:
  - Add boundary tests for `N-1`, `N`, `N+1` attempts (IP limit and account lockout separately).
  - Validate cooldown/reset behavior and ensure locked account remains denied even with correct credentials until admin unlock.
  - Validate security event persistence on lockout with correlation key for traceability.
- Quality risk severity gate:
  - Any P0/P1 defect in auth/session/security behavior blocks status transition to `review`.
  - Any accepted P2 defect must include issue ID, owner, and due date in QA evidence.
- Evidence gate for review handoff:
  - Attach automated test evidence for this story and impacted Epic 1 regression scenarios.
  - Attach negative-path replay result for `N-1`, `N`, `N+1` boundaries and session expiry paths.
  - Attach one correlation sample linking client-visible error to server-side security event/log.
- Party review resolution status (2026-02-25):
  - [ ] FE/MOB canonical mapping table evidence attached (`same code -> same semantics`) with diff-free review.
  - [ ] Lockout/expired/rate-limit recoverable next-action parity evidence attached for both clients.
  - [ ] Unknown-code fallback evidence attached (safe generic message + correlation id visibility).
  - [ ] Regression evidence attached ensuring mapping changes stay synchronized across FE and MOB lanes.

- Execution reference:
  - Run Epic 1 focused checklist: `_bmad-output/implementation-artifacts/epic-1-qa-reinforcement-checklist.md`.

Previous Story Intelligence

- From Story 1.5:
  - Security guardrail outputs define the error code set this story must normalize.
- From Stories 1.3 and 1.4:
  - Existing auth route and state behavior should be reused; only message/action harmonization is added.

Git Intelligence Summary

- Cross-lane changes are highest risk for drift.
- Keep FE and MOB mapping changes synchronized and reviewed together.

Latest Tech Information

- FE/MOB package versions refreshed from npm metadata.
- No preview dependencies required for standardization work.

Project Context Reference

- `project-context.md` not found in repository scan.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Ultimate context engine analysis completed - comprehensive developer guide created.

References

- `_bmad-output/planning-artifacts/epics.md` (Story 1.6)
- `_bmad-output/implementation-artifacts/epic-1-user-authentication-and-account-access.md`
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/planning-artifacts/ux-design-specification.md`
- https://registry.npmjs.org/react-router-dom
- https://registry.npmjs.org/zustand
- https://registry.npmjs.org/react-native

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated via create-story workflow instructions with Epic 1 artifact synthesis.

Completion Notes List

- Added cross-client parity guardrails and fallback/correlation-id requirements.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/1-6-fe-mob-auth-error-standardization.md","bmad","epic-1","story-1-6","lane-fe","bmad-status-ready-for-dev","FIX-17"
"Story 2.1: BE Schema and Auto Account Provisioning","Story","Story 2.1: BE Schema and Auto Account Provisioning

Status: ready-for-dev

Story

As an account-domain owner,
I want normalized account schema and provisioning endpoints,
so that every registered member has a usable account baseline.

Acceptance Criteria

- Given migration scripts, when service boots, then account/member tables are created with required constraints.
- Given successful member registration event, when provisioning endpoint is called, then default account is created idempotently.
- Given duplicate provisioning request, when same member is targeted, then account duplication does not occur.
- Given provisioning failure, when transaction is rolled back, then failure reason is returned with normalized code.

Tasks / Subtasks

- [ ] Implement and verify account-domain schema migrations (AC: 1)
  - [ ] Add/verify account table constraints (ownership, uniqueness, status defaults)
  - [ ] Ensure migration startup validation fails fast on mismatch
- [ ] Implement idempotent default-account provisioning flow (AC: 2)
  - [ ] Provide internal provisioning path for newly registered member
  - [ ] Guarantee one default account baseline per member policy
- [ ] Prevent duplicate account creation on retries/replays (AC: 3)
  - [ ] Enforce idempotency via constraint + deterministic conflict handling
  - [ ] Return stable success/duplicate semantics
- [ ] Implement rollback-safe failure handling (AC: 4)
  - [ ] Ensure failed provisioning leaves no partial account state
  - [ ] Return normalized error code with actionable reason
- [ ] Add integration tests for bootstrap/duplicate/failure scenarios (AC: 1, 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 2 (`2.1`~`2.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on Story 0.1 and Story 1.1.
- This story establishes account-domain baseline for all Epic 2 inquiry APIs.

Technical Requirements

- Schema and ownership:
  - Account domain must be migration-managed and deterministic at startup.
  - Provisioning must keep member-account ownership explicit and enforceable.
- Idempotency:
  - Repeated provisioning for the same member must not create duplicate accounts.
  - Retry behavior must be deterministic and safe under at-least-once invocation.
- Error contract:
  - Failures must return normalized codes/messages consistent with global API envelope.

Architecture Compliance

- Keep account schema ownership in corebank/account domain lane.
- Keep channel-to-corebank boundary internal and header-guarded for internal provisioning calls.
- Do not move account-creation ownership into client layers.

File Structure Requirements

- Expected touched areas:
  - `BE/corebank-service/src/main/**/account/**`
  - `BE/corebank-service/src/main/resources/db/migration/**`
  - `BE/channel-service/src/main/**/auth/**` (only if registration-provisioning hook requires integration)
  - `BE/*/src/test/**`

Testing Requirements

- Required checks:
  - Fresh boot applies account schema migrations successfully.
  - First provisioning call creates default account.
  - Duplicate provisioning call does not duplicate account rows.
  - Failure path rolls back and returns normalized failure code.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify `story_key <-> filename <-> sprint-status key` are identical.
- Idempotency boundary gate:
  - Validate duplicate/retry provisioning remains single-account outcome.
- Failure atomicity gate:
  - Validate partial writes are absent on provisioning failure.
- Evidence gate:
  - Attach integration evidence for success, duplicate, and rollback scenarios.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 2 story context prepared with account-domain guardrails.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 2, Story 2.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical Epic 2 planning artifact.

Completion Notes List

- Added canonical numbering and idempotent provisioning guardrails.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/2-1-schema-and-auto-account-provisioning.md","bmad","epic-2","story-2-1","lane-mixed","bmad-status-ready-for-dev","FIX-18"
"Story 2.2: BE Balance and Available-Balance API","Story","Story 2.2: BE Balance and Available-Balance API

Status: ready-for-dev

Story

As an authenticated user,
I want real-time balance information,
so that order decisions can be made safely.

Acceptance Criteria

- Given valid owned account, when balance API is called, then current balance and available balance are returned.
- Given non-owned account request, when authorization is checked, then access is denied.
- Given concurrent updates, when reads occur, then response remains transactionally consistent.
- Given downstream error, when query fails, then normalized retriable/non-retriable code is returned.

Tasks / Subtasks

- [ ] Implement owned-account balance inquiry endpoint (AC: 1)
  - [ ] Return current and available balance fields in stable contract
  - [ ] Preserve currency/as-of semantics consistently
- [ ] Enforce ownership authorization on account reads (AC: 2)
  - [ ] Deny non-owned account access deterministically
  - [ ] Keep forbidden behavior aligned with global error contract
- [ ] Ensure read consistency under concurrent writes (AC: 3)
  - [ ] Apply transaction/read strategy that avoids stale or contradictory balances
  - [ ] Add deterministic consistency assertions in tests
- [ ] Normalize downstream/query failure mapping (AC: 4)
  - [ ] Distinguish retriable/non-retriable failures with stable codes
  - [ ] Avoid leaking internal exception details
- [ ] Add integration tests for ownership, consistency, and error mapping (AC: 1, 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 2 (`2.1`~`2.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on Story 2.1 and Story 1.2.
- This story is the read-side contract baseline for FE/MOB dashboard flows.

Technical Requirements

- Contract:
  - Response must include both `balance` and `availableBalance` semantics.
  - Field meanings must remain stable across clients.
- Security:
  - Ownership verification is mandatory before balance disclosure.
- Consistency:
  - Reads during concurrent mutations must preserve transactional correctness.
- Error policy:
  - Retries must be guided by normalized retriable/non-retriable codes.

Architecture Compliance

- Keep account inquiry in corebank/channel service ownership boundaries.
- Preserve PII and account-number masking policy for user-facing surfaces.
- Follow standardized exception envelope and correlation behavior.

File Structure Requirements

- Expected touched areas:
  - `BE/channel-service/src/main/**/account/**`
  - `BE/corebank-service/src/main/**/account/**`
  - `BE/*/src/test/**`

Testing Requirements

- Required checks:
  - Owned account returns current and available balance.
  - Non-owned account access returns forbidden response.
  - Concurrent write/read scenario keeps deterministic balance contract.
  - Downstream failure maps to normalized retriable/non-retriable code.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify `story_key <-> filename <-> sprint-status key` are identical.
- Ownership gate:
  - Validate unauthorized account reads are denied without data leakage.
- Consistency gate:
  - Validate read contract remains coherent under concurrent updates.
- Evidence gate:
  - Attach tests covering owned/non-owned/concurrent/failure scenarios.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 2 balance inquiry guardrails prepared.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 2, Story 2.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical Epic 2 planning artifact.

Completion Notes List

- Added ownership and transactional-consistency verification gates.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/2-2-balance-and-available-balance-api.md","bmad","epic-2","story-2-2","lane-mixed","bmad-status-ready-for-dev","FIX-18"
"Story 2.3: BE Order History API","Story","Story 2.3: BE Order History API

Status: ready-for-dev

Story

As an authenticated user,
I want paginated order history,
so that I can inspect recent financial activity.

Acceptance Criteria

- Given owned account with order records, when history API is called, then results are paginated and ordered by created time desc.
- Given empty history, when query executes, then empty content contract is returned consistently.
- Given unauthorized account id, when access check fails, then API returns forbidden error.
- Given malformed pagination params, when validation runs, then 400 validation error is returned.

Tasks / Subtasks

- [ ] Implement paginated order history endpoint for owned accounts (AC: 1)
  - [ ] Enforce sort by created time descending
  - [ ] Return stable page metadata and content shape
- [ ] Implement empty-result consistency handling (AC: 2)
  - [ ] Return deterministic empty content contract without null-shape drift
- [ ] Enforce authorization guard by account ownership (AC: 3)
  - [ ] Return forbidden contract on non-owned account access
- [ ] Validate pagination parameters (AC: 4)
  - [ ] Reject malformed page/size inputs with normalized validation errors
- [ ] Add integration tests for pagination/empty/forbidden/validation (AC: 1, 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 2 (`2.1`~`2.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on Story 2.1 and Story 1.2.
- This story provides backend contract required by web/mobile history UI stories.

Technical Requirements

- Pagination contract:
  - Page metadata and ordering semantics must be deterministic.
  - Empty results must preserve same JSON shape as non-empty responses.
- Authorization:
  - History must be scoped to owned accounts only.
- Validation:
  - Negative or invalid paging parameters must fail with 400 validation contract.

Architecture Compliance

- Keep query ownership in channel/corebank service boundaries as defined by architecture.
- Preserve standardized error envelope for forbidden/validation failures.
- Avoid leaking non-owned order metadata in any failure path.

File Structure Requirements

- Expected touched areas:
  - `BE/channel-service/src/main/**/order/**`
  - `BE/corebank-service/src/main/**/order/**` (if delegated query path exists)
  - `BE/*/src/test/**`

Testing Requirements

- Required checks:
  - Paginated history returns ordered records and stable metadata.
  - Empty-history request returns deterministic empty content contract.
  - Unauthorized account history request returns forbidden error.
  - Malformed pagination returns 400 validation error.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify `story_key <-> filename <-> sprint-status key` are identical.
- Contract-shape gate:
  - Validate empty and non-empty responses keep consistent schema.
- Authorization gate:
  - Validate no leakage for unauthorized account history requests.
- Evidence gate:
  - Attach pagination, empty, forbidden, and validation test evidence.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 2 order-history API guardrails prepared.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 2, Story 2.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical Epic 2 planning artifact.

Completion Notes List

- Added pagination, authorization, and validation contract gates.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/2-3-order-history-api.md","bmad","epic-2","story-2-3","lane-mixed","bmad-status-ready-for-dev","FIX-18"
"Story 2.4: FE Web Portfolio Dashboard and History","Story","Story 2.4: FE Web Portfolio Dashboard and History

Status: ready-for-dev

Story

As a web user,
I want to view my accounts and order history,
so that account insights are available in one place.

Acceptance Criteria

- Given authenticated session, when dashboard loads, then account summary and balances are displayed.
- Given history tab interaction, when page/filter is changed, then server-driven history list updates correctly.
- Given API failure, when error occurs, then user sees standardized retry guidance.
- Given account number policy, when UI renders values, then masking format is applied consistently.

Tasks / Subtasks

- [ ] Implement dashboard account summary rendering (AC: 1)
  - [ ] Load and display owned account balances on initial dashboard view
  - [ ] Keep loading/error/empty states deterministic
- [ ] Implement history list with server-driven paging/filtering (AC: 2)
  - [ ] Sync page/filter controls with backend query contract
  - [ ] Prevent duplicate or stale list rendering on quick interactions
- [ ] Implement standardized API-failure guidance (AC: 3)
  - [ ] Reuse global error semantics and retry guidance pattern
  - [ ] Keep message/action consistency with FE auth error standards
- [ ] Apply account-number masking policy consistently (AC: 4)
  - [ ] Ensure full account number is never shown in user-facing surfaces
- [ ] Add FE tests for dashboard/history/error/masking behaviors (AC: 1, 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 2 (`2.1`~`2.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on Story 2.2, Story 2.3, and Story 1.3.
- This story consumes Epic 2 inquiry APIs and exposes them in FE dashboard UX.

Technical Requirements

- Data flow:
  - Dashboard must consume balance/account summary contract from backend.
  - History tab must use server-driven pagination/filtering semantics.
- UX consistency:
  - Error handling must follow standardized retry guidance pattern.
  - Masking rule must be identical across account list/history surfaces.

Architecture Compliance

- Keep web lane logic within FE submodule scope.
- Use shared API client/interceptor pattern; avoid per-page network divergence.
- Do not bypass backend ownership/masking rules with client-side assumptions.

File Structure Requirements

- Expected touched areas:
  - `FE/src/pages/**`
  - `FE/src/components/**`
  - `FE/src/lib/axios*`
  - `FE/src/store/**`
  - `FE/src/test/**`

Testing Requirements

- Required checks:
  - Authenticated dashboard renders account summary and balances.
  - History page/filter updates backend-driven list correctly.
  - API failure shows standardized retry guidance.
  - Masking rule is consistently applied to rendered account numbers.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify `story_key <-> filename <-> sprint-status key` are identical.
- FE contract gate:
  - Validate list/filter state stays synchronized with backend contract.
- Masking gate:
  - Validate full account number never appears in rendered UI.
- Evidence gate:
  - Attach UI test evidence for dashboard/history/error/masking cases.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 2 web dashboard/history guardrails prepared.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 2, Story 2.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/ux-design-specification.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical Epic 2 planning artifact.

Completion Notes List

- Added server-driven history sync and masking guardrails for FE.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/2-4-web-account-dashboard-and-history.md","bmad","epic-2","story-2-4","lane-mixed","bmad-status-ready-for-dev","FIX-18"
"Story 2.5: MOB Mobile Portfolio Dashboard and History","Story","Story 2.5: MOB Mobile Portfolio Dashboard and History

Status: ready-for-dev

Story

As a mobile user,
I want account dashboard and history on mobile,
so that parity with web is maintained.

Acceptance Criteria

- Given authenticated mobile session, when dashboard screen opens, then balances and account summaries render correctly.
- Given pull-to-refresh on history, when user requests refresh, then latest records load without duplications.
- Given empty or error response, when screen state resolves, then empty/error states follow UI standard.
- Given masked account display policy, when numbers render, then same masking rule as web is applied.

Tasks / Subtasks

- [ ] Implement mobile dashboard summary screen (AC: 1)
  - [ ] Render account balances and summaries for authenticated user
  - [ ] Keep loading and stale-state handling deterministic
- [ ] Implement history refresh behavior (AC: 2)
  - [ ] Wire pull-to-refresh with dedup-safe state updates
  - [ ] Preserve server-driven ordering semantics in refreshed lists
- [ ] Implement standardized empty/error states (AC: 3)
  - [ ] Align screen-state behavior with mobile UI standards
  - [ ] Reuse shared network error normalization path
- [ ] Apply web-parity masking rules in mobile rendering (AC: 4)
  - [ ] Ensure full account numbers are never shown
- [ ] Add mobile tests for dashboard/history/empty/error/masking behavior (AC: 1, 2, 3, 4)

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 2 (`2.1`~`2.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on Story 2.2, Story 2.3, and Story 1.4.
- This story establishes mobile parity for account inquiry UX.

Technical Requirements

- Data and parity:
  - Dashboard/history contracts must match backend semantics used by web.
  - Refresh behavior must avoid duplicate entries and stale-state drift.
- UX consistency:
  - Empty/error states must follow mobile standard patterns.
  - Masking rule must match FE output semantics.

Architecture Compliance

- Keep implementation within MOB lane boundaries.
- Use centralized mobile network layer and shared error normalization path.
- Do not implement screen-local parsing branches that diverge from shared contract.

File Structure Requirements

- Expected touched areas:
  - `MOB/src/screens/**`
  - `MOB/src/navigation/**`
  - `MOB/src/network/**`
  - `MOB/src/store/**`
  - `MOB/src/test/**`

Testing Requirements

- Required checks:
  - Authenticated dashboard renders balance summary correctly.
  - Pull-to-refresh updates latest history without duplication.
  - Empty/error states match mobile UI standard.
  - Account masking output matches web parity rule.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify `story_key <-> filename <-> sprint-status key` are identical.
- Refresh-consistency gate:
  - Validate pull-to-refresh does not create duplicates or stale merges.
- Parity gate:
  - Validate masking and error-state semantics match FE parity expectations.
- Evidence gate:
  - Attach mobile test evidence for dashboard/history/empty/error/masking scenarios.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 2 mobile dashboard/history parity guardrails prepared.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 2, Story 2.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/ux-design-specification.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical Epic 2 planning artifact.

Completion Notes List

- Added mobile refresh-dedup and FE/MOB masking-parity guardrails.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/2-5-mobile-account-dashboard-and-history.md","bmad","epic-2","story-2-5","lane-mixed","bmad-status-ready-for-dev","FIX-18"
"Story 2.6: BE Account Status Contract","Story","Story 2.6: BE Account Status Contract

Status: ready-for-dev

Story

As an account admin system,
I want explicit account status contract,
so that lock/unlock and order eligibility can be governed consistently.

Acceptance Criteria

- Given account status model, when status endpoint is queried, then `ACTIVE/LOCKED` and related metadata are returned.
- Given locked account, when order flow requests eligibility, then denial reason code is deterministic.
- Given status transition event, when status changes, then audit/security event is emitted.

Tasks / Subtasks

- [ ] Implement account status query contract (AC: 1)
  - [ ] Expose status response with metadata fields required by callers
  - [ ] Keep enum/value semantics stable (`ACTIVE`, `LOCKED`)
- [ ] Implement order-eligibility evaluation contract (AC: 2)
  - [ ] Return deterministic denial reason code for locked/non-eligible states
  - [ ] Ensure caller-visible behavior is consistent across repeated checks
- [ ] Emit audit/security event on status transitions (AC: 3)
  - [ ] Record transition actor/context/reason in structured event payload
  - [ ] Ensure event emission is coupled to committed status transition
- [ ] Add integration tests for status query, eligibility denial, and event emission

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 2 (`2.1`~`2.6`).
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on Story 2.1.
- This story defines status semantics consumed by later order-governance flows.

Technical Requirements

- Contract stability:
  - Status enum and metadata must be explicit and forward-compatible.
  - Eligibility denial reason must be deterministic for same state/input.
- Governance:
  - Status transitions must emit traceable audit/security events.
- Integration:
  - Downstream order logic must be able to consume eligibility contract without interpretation drift.

Architecture Compliance

- Keep status model and transition ownership in account-domain backend lane.
- Align event emission with audit/security event model conventions.
- Preserve normalized error/event/correlation practices across services.

File Structure Requirements

- Expected touched areas:
  - `BE/corebank-service/src/main/**/account/**`
  - `BE/channel-service/src/main/**/account/**` (if eligibility contract is proxied)
  - `BE/*/src/main/**/audit/**` or `**/security-events/**`
  - `BE/*/src/test/**`

Testing Requirements

- Required checks:
  - Status endpoint returns `ACTIVE/LOCKED` and metadata correctly.
  - Locked-account eligibility check returns deterministic denial code.
  - Status transitions emit expected audit/security event payload.

Quinn Reinforcement Checks

- Numbering regression gate:
  - Verify `story_key <-> filename <-> sprint-status key` are identical.
- Contract determinism gate:
  - Validate same status input yields same eligibility denial code.
- Event integrity gate:
  - Validate status transition emits one traceable audit/security event.
- Evidence gate:
  - Attach status/eligibility/event integration test evidence.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 2 account-status governance guardrails prepared.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 2, Story 2.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-2-order-session-and-otp.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical Epic 2 planning artifact.

Completion Notes List

- Added deterministic status/eligibility and audit-event emission guardrails.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/2-6-account-status-contract.md","bmad","epic-2","story-2-6","lane-mixed","bmad-status-ready-for-dev","FIX-18"
"Story 3.1: [FEP] FEP DTO/Client Contract","Story","Story 3.1: [FEP] FEP DTO/Client Contract

Status: ready-for-dev

Story

As a FEP owner,
I want a strict request/response contract layer,
So that channel-to-FEP integration is deterministic.

Acceptance Criteria

- Given outbound order payload When mapped to FEP DTO Then required fields are validated before send.
- Given response payload from FEP When parsed Then internal contract is mapped with explicit status values.
- Given contract-breaking change When build/test runs Then failing contract test blocks merge.
- Given contract versioning policy When schema evolves Then backward compatibility rule is enforced.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 3.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 0.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 3 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 3, Story 3.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 3.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/3-1-fep-dto-client-contract.md","bmad","epic-3","story-3-1","lane-fep","bmad-status-ready-for-dev","FIX-19"
"Story 3.2: [FEP] External Error Taxonomy","Story","Story 3.2: [FEP] External Error Taxonomy

Status: ready-for-dev

Story

As a platform consumer,
I want normalized external error codes,
So that upstream systems handle failures consistently.

Acceptance Criteria

- Given FEP rejection/system errors When adapter receives them Then internal error taxonomy is applied deterministically.
- Given unmapped FEP code When received Then fallback unknown-external code is returned.
- Given mapped external error When propagated to channel Then user-facing message key and operator code are both available.
- Given taxonomy table update When regression test runs Then mapping matrix assertions pass.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 3.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 3 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 3, Story 3.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 3.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/3-2-external-error-taxonomy.md","bmad","epic-3","story-3-2","lane-mixed","bmad-status-ready-for-dev","FIX-19"
"Story 3.3: [FEP] ReferenceId & Idempotency Policy","Story","Story 3.3: [FEP] ReferenceId & Idempotency Policy

Status: ready-for-dev

Story

As a resilience engineer,
I want idempotent external request identity,
So that duplicate transmission never causes double execution.

Acceptance Criteria

- Given duplicate external request identity When replayed Then adapter returns existing processing context.
- Given cross-owner duplicate misuse When validation executes Then request is rejected as unauthorized.
- Given idempotency retention window When expired key is reused Then policy behavior is deterministic and documented.
- Given replay-denied case When handled Then security/audit event is recorded.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 3.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 3 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 3, Story 3.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 3.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/3-3-referenceid-and-idempotency-policy.md","bmad","epic-3","story-3-3","lane-mixed","bmad-status-ready-for-dev","FIX-19"
"Story 3.4: [FEP] FEP Status Query API","Story","Story 3.4: [FEP] FEP Status Query API

Status: ready-for-dev

Story

As a recovery scheduler,
I want status requery for external orders,
So that UNKNOWN/EXECUTING outcomes can be reconciled.

Acceptance Criteria

- Given known external reference When status API is queried Then latest known status is returned in normalized shape.
- Given unknown external reference When status API is queried Then UNKNOWN result is returned without schema drift.
- Given temporary external timeout When status query fails Then retriable classification is returned.
- Given repeated query from scheduler When threshold is exceeded Then escalation signal is produced.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 3.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 3 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 3, Story 3.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 3.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/3-4-fep-status-query-api.md","bmad","epic-3","story-3-4","lane-fep","bmad-status-ready-for-dev","FIX-19"
"Story 3.5: [FEP] Contract Test Suite","Story","Story 3.5: [FEP] Contract Test Suite

Status: ready-for-dev

Story

As a quality owner,
I want contract tests for FEP integration,
So that integration drift is detected before release.

Acceptance Criteria

- Given canonical WireMock stubs When CI runs Then request header/body and response mapping assertions pass.
- Given changed contract field When stub and mapper diverge Then pipeline fails with explicit mismatch.
- Given error taxonomy scenarios When test matrix executes Then all expected code mappings are validated.
- Given correlation-id propagation requirement When outbound call verified Then trace header presence is asserted.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 3.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.2, Story 3.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 3 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 3, Story 3.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 3.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/3-5-contract-test-suite.md","bmad","epic-3","story-3-5","lane-mixed","bmad-status-ready-for-dev","FIX-19"
"Story 3.6: Visible External Error UX","Story","Story 3.6: Visible External Error UX

Status: ready-for-dev

Story

As an order user,
I want understandable external-failure messages,
So that I know whether to retry, wait, or contact support.

Acceptance Criteria

- Given external failure code mapping When FE/MOB receives error Then action-oriented message is displayed.
- Given ambiguous unknown external state When shown to user Then recovery guidance avoids false completion claims.
- Given same error code on FE and MOB When rendered Then parity of UX semantics is maintained.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 3.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 3 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 3, Story 3.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-3-fault-tolerance-and-fep-resilience.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 3.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/3-6-visible-external-error-ux.md","bmad","epic-3","story-3-6","lane-mixed","bmad-status-ready-for-dev","FIX-19"
"Story 4.1: [CH] Order Session Create/Status + Ownership","Story","Story 4.1: [CH] Order Session Create/Status + Ownership

Status: ready-for-dev

Story

As a channel API owner,
I want order session creation and status queries with ownership checks,
So that unauthorized access and invalid session usage are blocked.

Acceptance Criteria

- Given valid order initiation request When session API is called Then session is created with PENDING_NEW status and TTL.
- Given status query for owned session When endpoint is called Then current session state is returned.
- Given non-owner session access When query or action occurs Then forbidden error is returned.
- Given expired session When status/action is requested Then not-found/expired contract is returned.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 1.2, Story 2.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-1-order-session-create-status-plus-ownership.md","bmad","epic-4","story-4-1","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 4.2: [CH] OTP Verification Policy","Story","Story 4.2: [CH] OTP Verification Policy

Status: ready-for-dev

Story

As an authenticated order initiator,
I want robust OTP verification controls,
So that step-up authentication is secure and abuse-resistant.

Acceptance Criteria

- Given valid OTP in allowed time window When verify endpoint is called Then verification succeeds and session can advance.
- Given duplicate rapid verify attempts When debounce policy applies Then request is throttled without attempt over-consumption.
- Given OTP replay in same window When replay is detected Then request is rejected.
- Given max attempts exceeded When further verify is attempted Then session is failed and execution blocked.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 4.1, Story 1.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-2-otp-verification-policy.md","bmad","epic-4","story-4-2","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 4.3: [CH] FSM Transition Governance","Story","Story 4.3: [CH] FSM Transition Governance

Status: ready-for-dev

Story

As a domain owner,
I want explicit order session transition rules,
So that invalid state progression cannot occur.

Acceptance Criteria

- Given order FSM definition When state transition command is applied Then only allowed transitions are accepted.
- Given invalid transition request When attempted Then deterministic conflict/error is returned.
- Given state persistence event When transition completes Then status and timestamps are stored consistently.
- Given API status response When serialized Then optional fields follow status-specific contract.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 4.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-3-fsm-transition-governance.md","bmad","epic-4","story-4-3","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 4.4: [FE] Web Order Step A/B","Story","Story 4.4: [FE] Web Order Step A/B

Status: ready-for-dev

Story

As a web user,
I want step-based order input and OTP preparation flow,
So that order setup is clear and reversible.

Acceptance Criteria

- Given step A order form When user submits valid input Then session initiation API is called successfully.
- Given invalid form data When validation runs Then client-side and server-side errors are shown.
- Given transition to step B When session enters PENDING_NEW Then OTP input UI becomes active.
- Given API/network error When request fails Then user receives retry guidance.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 4.1, Story 2.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-4-web-order-step-a-b.md","bmad","epic-4","story-4-4","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 4.5: [FE] Web OTP + Step C","Story","Story 4.5: [FE] Web OTP + Step C

Status: ready-for-dev

Story

As a web user,
I want OTP verification and final confirmation/result screens,
So that I can complete order with clear status feedback.

Acceptance Criteria

- Given valid OTP submission When verify succeeds Then UI transitions to confirmation/execution step.
- Given OTP failure cases When code is invalid/expired/replayed Then mapped error message is displayed.
- Given execution in progress When status polling/subscription updates Then result screen reflects final state.
- Given final state response When completed/failed returned Then reference and reason fields are rendered conditionally.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 4.2, Story 4.3, Story 4.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-5-web-otp-plus-step-c.md","bmad","epic-4","story-4-5","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 4.6: [MOB] Mobile Order Step A/B","Story","Story 4.6: [MOB] Mobile Order Step A/B

Status: ready-for-dev

Story

As a mobile user,
I want order input and OTP preparation on mobile flow,
So that I can initiate an order with same capability as web.

Acceptance Criteria

- Given step A mobile form When submission succeeds Then session is created and step B is shown.
- Given invalid amount/account input When validation fails Then contextual error indicators are displayed.
- Given OTP pending session When user navigates to OTP step Then remaining session context is preserved.
- Given navigation interruption When user returns Then state restoration logic preserves flow continuity.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 4.1, Story 2.5.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-6-mobile-order-step-a-b.md","bmad","epic-4","story-4-6","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 4.7: [MOB] Mobile OTP + Step C","Story","Story 4.7: [MOB] Mobile OTP + Step C

Status: ready-for-dev

Story

As a mobile user,
I want OTP verification and final result flow on mobile,
So that complete order experience is parity with web.

Acceptance Criteria

- Given OTP verify on mobile When valid code is entered Then app transitions to confirmation/execution.
- Given OTP or execution errors When response received Then user sees mapped action guidance.
- Given final result response When completed/failed Then order reference and failure reasons are rendered.
- Given app background/foreground cycle When session resumes Then current order status is recovered.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 4.2, Story 4.3, Story 4.6.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.7)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-7-mobile-otp-plus-step-c.md","bmad","epic-4","story-4-7","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 4.8: Cross-client FSM Parity Validation","Story","Story 4.8: Cross-client FSM Parity Validation

Status: ready-for-dev

Story

As a product quality owner,
I want FE and MOB FSM behavior parity,
So that one client does not diverge from core order rules.

Acceptance Criteria

- Given same scenario input sequence When run on FE and MOB Then state transitions are equivalent.
- Given same error codes When rendered on both clients Then severity/action semantics are aligned.
- Given regression suite When CI runs Then parity checks pass.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 4.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 4.5, Story 4.7.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 4 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 4, Story 4.8)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-4-order-execution-and-position-integrity.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 4.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/4-8-cross-client-fsm-parity-validation.md","bmad","epic-4","story-4-8","lane-mixed","bmad-status-ready-for-dev","FIX-20"
"Story 5.1: [AC] Limit Engine","Story","Story 5.1: [AC] Limit Engine

Status: ready-for-dev

Story

As an account policy engine,
I want daily amount/count validation,
So that order attempts respect financial policy.

Acceptance Criteria

- Given order request with account context When limit check executes Then remaining capacity is computed accurately.
- Given request exceeds limit When validation fails Then rejection includes remaining-limit metadata.
- Given exactly-at-limit request When check runs Then acceptance/rejection behavior follows documented boundary.
- Given daily window rollover When date boundary changes Then counters reset according to timezone rule.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 5.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 2.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 5 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 5, Story 5.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 5.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/5-1-limit-engine.md","bmad","epic-5","story-5-1","lane-mixed","bmad-status-ready-for-dev","FIX-21"
"Story 5.2: [AC] Order Execution & Position Update","Story","Story 5.2: [AC] Order Execution & Position Update

Status: ready-for-dev

Story

As a ledger engine,
I want atomic debit/credit posting for FEP-routed orders,
So that ledger integrity is preserved.

Acceptance Criteria

- Given authorized order execution When posting occurs Then paired debit/credit entries are committed atomically.
- Given posting failure mid-transaction When transaction aborts Then neither partial ledger entry persists.
- Given insufficient balance condition When posting pre-check fails Then no ledger mutation occurs.
- Given successful posting When response is built Then order reference is included.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 5.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 5.1, Story 4.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 5 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 5, Story 5.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 5.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/5-2-order-execution-and-position-update.md","bmad","epic-5","story-5-2","lane-mixed","bmad-status-ready-for-dev","FIX-21"
"Story 5.3: [AC] FEP Order Execution Semantics","Story","Story 5.3: [AC] FEP Order Execution Semantics

Status: ready-for-dev

Story

As a FEP execution owner,
I want deterministic posting semantics for external orders,
So that local ledger stays consistent with external processing lifecycle.

Acceptance Criteria

- Given FEP-routed order execution request When pre-posting/debit occurs Then order state records external linkage metadata.
- Given external failure requiring compensation When compensation path runs Then compensating credit is recorded with traceable linkage.
- Given external unknown outcome When settlement deferred Then ledger state remains reconcilable for later recovery.
- Given FEP order FILLED When finalized Then final order status (FILLED) and clOrdID references are consistent.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 5.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 5.1, Story 3.2, Story 4.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 5 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 5, Story 5.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 5.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/5-3-fep-order-execution-semantics.md","bmad","epic-5","story-5-3","lane-mixed","bmad-status-ready-for-dev","FIX-21"
"Story 5.4: [AC] Idempotent Posting","Story","Story 5.4: [AC] Idempotent Posting

Status: ready-for-dev

Story

As a order safety owner,
I want duplicate execution suppression,
So that repeated client/system calls do not double-post.

Acceptance Criteria

- Given same idempotency key and same owner When execution retried Then original result is returned without new posting.
- Given same key from different owner When request arrives Then unauthorized duplication is rejected.
- Given concurrent duplicate requests When race occurs Then only one posting path commits.
- Given dedupe hit When response returned Then idempotency indicator is included for diagnostics.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 5.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 5.2, Story 5.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 5 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 5, Story 5.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 5.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/5-4-idempotent-posting.md","bmad","epic-5","story-5-4","lane-mixed","bmad-status-ready-for-dev","FIX-21"
"Story 5.5: [AC] Concurrency Control","Story","Story 5.5: [AC] Concurrency Control

Status: ready-for-dev

Story

As a corebank integrity owner,
I want pessimistic locking and race-safe behavior,
So that concurrent orders cannot produce negative or corrupted balances.

Acceptance Criteria

- Given concurrent order attempts on same account When lock policy is applied Then final balance never becomes negative.
- Given lock contention When threshold exceeded Then request fails with deterministic conflict/error contract.
- Given 10-thread concurrency test When executed in CI Then expected success/failure counts and final balance assertions pass.
- Given lock duration observation When measured Then operational threshold alerting is available.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 5.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 5.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 5 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 5, Story 5.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 5.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/5-5-concurrency-control.md","bmad","epic-5","story-5-5","lane-mixed","bmad-status-ready-for-dev","FIX-21"
"Story 5.6: [AC] Ledger Integrity","Story","Story 5.6: [AC] Ledger Integrity

Status: ready-for-dev

Story

As a finance correctness owner,
I want ledger invariant checks and repair visibility,
So that accounting integrity can be continuously verified.

Acceptance Criteria

- Given completed order set When integrity query runs Then debit/credit(+compensate) invariants hold.
- Given detected mismatch When integrity check fails Then anomaly is reported with traceable identifiers.
- Given scheduled integrity job When executed Then summary metrics are stored for operations.
- Given release gate When ledger integrity test fails Then build is blocked.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 5.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 5.2, Story 5.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 5 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 5, Story 5.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 5.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/5-6-ledger-integrity.md","bmad","epic-5","story-5-6","lane-mixed","bmad-status-ready-for-dev","FIX-21"
"Story 5.7: Visible Result/Error UX","Story","Story 5.7: Visible Result/Error UX

Status: ready-for-dev

Story

As an order user,
I want limit/balance/result failures clearly explained,
So that I can take the correct next action.

Acceptance Criteria

- Given insufficient balance/limit errors When FE/MOB receives codes Then both clients show aligned actionable guidance.
- Given order failure reason code When rendered Then reason category is distinguishable (internal/external/validation).
- Given successful order completion When result rendered Then reference and updated balance context are shown where required.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 5.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 5.1, Story 4.8.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 5 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 5, Story 5.7)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-5-real-time-notifications.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 5.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/5-7-visible-result-error-ux.md","bmad","epic-5","story-5-7","lane-mixed","bmad-status-ready-for-dev","FIX-21"
"Story 6.1: [FEP] Timeout & Circuit Breaker","Story","Story 6.1: [FEP] Timeout & Circuit Breaker

Status: ready-for-dev

Story

As a resilience owner,
I want timeout and circuit breaker policies enforced,
So that repeated external failures do not cascade.

Acceptance Criteria

- Given external call exceeding timeout threshold When request executes Then timeout classification is returned.
- Given consecutive failures at configured threshold When next call occurs Then circuit breaker transitions to open behavior.
- Given cool-down window elapsed When probe request succeeds Then breaker transitions toward closed state.
- Given probe request fails When half-open state active Then breaker returns to open.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 6.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 6 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 6, Story 6.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 6.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/6-1-timeout-and-circuit-breaker.md","bmad","epic-6","story-6-1","lane-mixed","bmad-status-ready-for-dev","FIX-22"
"Story 6.2: [FEP] Retry Boundary Policy","Story","Story 6.2: [FEP] Retry Boundary Policy

Status: ready-for-dev

Story

As a systems architect,
I want clear retry boundaries,
So that non-idempotent paths are not retried dangerously.

Acceptance Criteria

- Given retriable status query failure When policy applies Then bounded retry executes.
- Given non-retriable execution path When failure occurs Then no automatic duplicate execution retry occurs.
- Given retry exhausted When final error returned Then classification includes retry metadata.
- Given policy review When runbook checked Then retriable/non-retriable matrix is documented.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 6.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 6.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 6 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 6, Story 6.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 6.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/6-2-retry-boundary-policy.md","bmad","epic-6","story-6-2","lane-mixed","bmad-status-ready-for-dev","FIX-22"
"Story 6.3: [FEP] Chaos Control API","Story","Story 6.3: [FEP] Chaos Control API

Status: ready-for-dev

Story

As an operations engineer,
I want runtime chaos controls,
So that resilience scenarios can be demonstrated and tested reliably.

Acceptance Criteria

- Given admin chaos mode endpoint When mode set to NORMAL/TIMEOUT/FAILURE Then subsequent behavior reflects chosen mode.
- Given non-admin access When mode change is attempted Then request is denied.
- Given chaos config query endpoint When called Then active mode and parameters are returned.
- Given mode switch audit requirement When mode changes Then operational event is logged.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 6.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 6 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 6, Story 6.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 6.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/6-3-chaos-control-api.md","bmad","epic-6","story-6-3","lane-mixed","bmad-status-ready-for-dev","FIX-22"
"Story 6.4: [FEP] UNKNOWN Requery Scheduler","Story","Story 6.4: [FEP] UNKNOWN Requery Scheduler

Status: ready-for-dev

Story

As a recovery engine,
I want periodic requery for unknown outcomes,
So that ambiguous orders can converge to terminal states.

Acceptance Criteria

- Given order in UNKNOWN/EXECUTING timeout state When scheduler runs Then status requery is executed with backoff policy.
- Given requery returns accepted/completed When reconciliation runs Then order state converges to terminal success.
- Given requery repeatedly unknown/failing When threshold exceeded Then order is escalated to manual recovery queue.
- Given scheduler cycle execution When metrics collected Then attempt and convergence counters are recorded.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 6.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.4, Story 6.2, Story 4.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 6 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 6, Story 6.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 6.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/6-4-unknown-requery-scheduler.md","bmad","epic-6","story-6-4","lane-mixed","bmad-status-ready-for-dev","FIX-22"
"Story 6.5: [FEP] Manual Replay/Recovery API","Story","Story 6.5: [FEP] Manual Replay/Recovery API

Status: ready-for-dev

Story

As an operator,
I want controlled replay/recovery commands,
So that unresolved orders can be corrected safely.

Acceptance Criteria

- Given authorized operator request When replay endpoint called Then operation is accepted with replay tracking id.
- Given unauthorized caller When replay is attempted Then forbidden response and security event are produced.
- Given duplicate replay request When same replay identity used Then idempotent replay behavior is enforced.
- Given replay completion/failure When operation ends Then final result is auditable.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 6.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 6.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 6 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 6, Story 6.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 6.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/6-5-manual-replay-recovery-api.md","bmad","epic-6","story-6-5","lane-mixed","bmad-status-ready-for-dev","FIX-22"
"Story 6.6: [FEP] Resilience Scenario Tests","Story","Story 6.6: [FEP] Resilience Scenario Tests

Status: ready-for-dev

Story

As a quality owner,
I want scenario tests for timeout/cb/recovery,
So that resilience behavior is proven before release.

Acceptance Criteria

- Given controlled timeout scenario When repeated failures occur Then CB open transition is asserted.
- Given recovery probe scenario When downstream recovers Then CB close transition path is asserted.
- Given UNKNOWN requery scenario When scheduler executes Then convergence/escalation outcomes are asserted.
- Given CI gate policy When resilience tests fail Then merge/release is blocked.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 6.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 6.1, Story 6.2, Story 6.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 6 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 6, Story 6.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 6.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/6-6-resilience-scenario-tests.md","bmad","epic-6","story-6-6","lane-mixed","bmad-status-ready-for-dev","FIX-22"
"Story 6.7: Degraded Operation UX","Story","Story 6.7: Degraded Operation UX

Status: ready-for-dev

Story

As an order user,
I want transparent degraded-state guidance,
So that I understand delays and recovery behavior.

Acceptance Criteria

- Given degraded external mode signal When FE/MOB receives state Then banner/notice communicates delay and expected behavior.
- Given recovery complete signal When state normalizes Then warning UI is cleared.
- Given prolonged unresolved state When threshold exceeded Then user sees support/escalation guidance.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 6.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 6.3, Story 6.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 6 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 6, Story 6.7)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-6-security-audit-and-administration.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 6.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/6-7-degraded-operation-ux.md","bmad","epic-6","story-6-7","lane-mixed","bmad-status-ready-for-dev","FIX-22"
"Story 7.1: [CH] SSE Stream Registry","Story","Story 7.1: [CH] SSE Stream Registry

Status: ready-for-dev

Story

As a notification backend owner,
I want SSE stream lifecycle management,
So that users receive order outcomes in real time.

Acceptance Criteria

- Given authenticated SSE stream request When connection established Then emitter is registered for member identity.
- Given duplicate connection for same member When new stream opens Then previous stream is replaced safely.
- Given disconnected or failed emitter When send fails Then registry cleanup occurs.
- Given heartbeat policy When stream idle Then keepalive events are emitted.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 7.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 1.2, Story 4.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 7 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 7, Story 7.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 7.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/7-1-sse-stream-registry.md","bmad","epic-7","story-7-1","lane-mixed","bmad-status-ready-for-dev","FIX-23"
"Story 7.2: [CH] Notification Persistence APIs","Story","Story 7.2: [CH] Notification Persistence APIs

Status: ready-for-dev

Story

As a notification user,
I want persisted notification history and read-state APIs,
So that missed events can be recovered.

Acceptance Criteria

- Given order terminal event When notification pipeline runs Then notification is persisted before/with dispatch.
- Given list API request When pagination params applied Then ordered notifications are returned.
- Given read-mark request When notification id belongs to user Then read status is updated.
- Given unauthorized notification access When validation fails Then request is denied.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 7.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 7.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 7 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 7, Story 7.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 7.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/7-2-notification-persistence-apis.md","bmad","epic-7","story-7-2","lane-mixed","bmad-status-ready-for-dev","FIX-23"
"Story 7.3: [FE] Web Notification Center","Story","Story 7.3: [FE] Web Notification Center

Status: ready-for-dev

Story

As a web user,
I want real-time notification center with reconnection behavior,
So that order results are visible even across brief disconnections.

Acceptance Criteria

- Given authenticated web session When app mounts provider Then single SSE connection is established.
- Given SSE disconnect When retry policy executes Then bounded retries occur before fallback.
- Given missed-event window When reconnection succeeds Then fallback list API backfills notifications.
- Given no notifications When feed renders Then empty state message is shown.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 7.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 7.1, Story 7.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 7 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 7, Story 7.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 7.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/7-3-web-notification-center.md","bmad","epic-7","story-7-3","lane-mixed","bmad-status-ready-for-dev","FIX-23"
"Story 7.4: [MOB] Mobile Notification Feed","Story","Story 7.4: [MOB] Mobile Notification Feed

Status: ready-for-dev

Story

As a mobile user,
I want in-app notification feed and reconnection,
So that order outcomes remain visible on mobile.

Acceptance Criteria

- Given active mobile session When notification module starts Then live updates are received and stored in UI state.
- Given app network loss/recovery When connection is restored Then missed notifications are synchronized.
- Given notification read action When user marks as read Then read state is reflected in app and backend.
- Given repeated disconnects When retry threshold exceeded Then user sees retry guidance.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 7.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 7.1, Story 7.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 7 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 7, Story 7.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 7.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/7-4-mobile-notification-feed.md","bmad","epic-7","story-7-4","lane-mixed","bmad-status-ready-for-dev","FIX-23"
"Story 7.5: [CH] Admin Session & Audit APIs","Story","Story 7.5: [CH] Admin Session & Audit APIs

Status: ready-for-dev

Story

As an administrator,
I want forced session invalidation and audit retrieval,
So that security incidents can be handled quickly.

Acceptance Criteria

- Given admin role request When invalidate-session API called Then target member sessions are removed.
- Given audit query filters When endpoint executes Then paginated and filterable audit list is returned.
- Given non-admin caller When admin API is called Then forbidden response is returned.
- Given privileged action executed When operation completes Then admin identity is recorded.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 7.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 1.2, Story 8.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 7 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 7, Story 7.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 7.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/7-5-admin-session-and-audit-apis.md","bmad","epic-7","story-7-5","lane-mixed","bmad-status-ready-for-dev","FIX-23"
"Story 7.6: [FE] Web Admin Console Screens","Story","Story 7.6: [FE] Web Admin Console Screens

Status: ready-for-dev

Story

As an operations admin,
I want web screens for security administration,
So that privileged tasks can be done without direct API tooling.

Acceptance Criteria

- Given admin authenticated user When admin console opened Then session-invalidate and audit search UIs are available.
- Given unauthorized user When route access attempted Then access is blocked.
- Given admin action result When API responds Then success/failure feedback is shown.
- Given audit filter input When search executed Then result list and pagination work correctly.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 7.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 7.5.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 7 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 7, Story 7.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 7.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/7-6-web-admin-console-screens.md","bmad","epic-7","story-7-6","lane-mixed","bmad-status-ready-for-dev","FIX-23"
"Story 7.7: [CH] Channel Security Hardening","Story","Story 7.7: [CH] Channel Security Hardening

Status: ready-for-dev

Story

As a security owner,
I want channel-side CSRF/rate-limit/cookie hardening,
So that abuse and session attacks are mitigated.

Acceptance Criteria

- Given sensitive endpoints When rate-limit policy applied Then endpoint-specific thresholds are enforced.
- Given state-changing browser requests When CSRF validation runs Then invalid token requests are blocked.
- Given session cookie issuance When response generated Then secure cookie attributes are enforced.
- Given direct internal endpoint call without secret When request reaches boundary Then blocked with security error.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 7.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 1.5, Story 4.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 7 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 7, Story 7.7)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-7-observability-api-docs-and-readme.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 7.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/7-7-channel-security-hardening.md","bmad","epic-7","story-7-7","lane-mixed","bmad-status-ready-for-dev","FIX-23"
"Story 8.1: [CH] Audit/Security Event Model","Story","Story 8.1: [CH] Audit/Security Event Model

Status: ready-for-dev

Story

As a compliance owner,
I want audit and security event schemas with retention rules,
So that investigations and compliance checks are reliable.

Acceptance Criteria

- Given significant user/system actions When events occur Then audit or security event is persisted in correct store.
- Given retention schedule When cleanup job runs Then records older than policy are purged.
- Given privileged actions When performed by admin Then actor identity is captured.
- Given event insert failure When exception occurs Then fallback operational log captures failure context.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 8.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 1.2, Story 4.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 8 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 8, Story 8.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 8.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/8-1-audit-security-event-model.md","bmad","epic-8","story-8-1","lane-mixed","bmad-status-ready-for-dev","FIX-24"
"Story 8.2: [CH] PII Masking Enforcement","Story","Story 8.2: [CH] PII Masking Enforcement

Status: ready-for-dev

Story

As a security engineer,
I want sensitive data masking in logs,
So that credentials/session data/account numbers are never leaked.

Acceptance Criteria

- Given logging of order/auth contexts When sensitive fields included Then masking rules are applied.
- Given password/otp/session token values When logging attempted Then raw values are never persisted.
- Given masking utility tests When test suite runs Then representative patterns are validated.
- Given log compliance check When release gate runs Then prohibited pattern scan returns clean.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 8.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 8.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 8 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 8, Story 8.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 8.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/8-2-pii-masking-enforcement.md","bmad","epic-8","story-8-2","lane-mixed","bmad-status-ready-for-dev","FIX-24"
"Story 8.3: [CH/FEP] Correlation-id 3-hop Propagation","Story","Story 8.3: [CH/FEP] Correlation-id 3-hop Propagation

Status: ready-for-dev

Story

As an observability owner,
I want consistent correlation id propagation across CH -> AC -> FEP,
So that end-to-end traces are reconstructable.

Acceptance Criteria

- Given inbound request without correlation id When channel filter runs Then new id is generated and returned in response header.
- Given internal downstream calls When channel calls account and FEP Then same correlation id is propagated.
- Given log aggregation query When searching by correlation id Then all four backend services show traceable chain.
- Given propagation regression test When CI runs Then 3-hop header assertions pass.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 8.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 3.1, Story 2.2, Story 4.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 8 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 8, Story 8.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 8.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/8-3-correlation-id-3-hop-propagation.md","bmad","epic-8","story-8-3","lane-mixed","bmad-status-ready-for-dev","FIX-24"
"Story 8.4: [CH/AC/FEP] OpenAPI Completeness","Story","Story 8.4: [CH/AC/FEP] OpenAPI Completeness

Status: ready-for-dev

Story

As a platform consumer,
I want consistent API docs across services,
So that integration and test automation are reliable.

Acceptance Criteria

- Given `docs-publish.yml` succeeds on `main` When canonical API docs endpoint (`https://<org>.github.io/<repo>/`) is accessed Then docs selector tabs for required services are reachable.
- Given controller endpoints When docs generated Then operation summaries and response schemas are present.
- Given error codes When docs reviewed Then common failure responses are documented.
- Given API change When contract diff check runs Then undocumented changes fail review gate.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 8.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 1.2, Story 2.2, Story 3.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 8 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 8, Story 8.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 8.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/8-4-openapi-completeness.md","bmad","epic-8","story-8-4","lane-mixed","bmad-status-ready-for-dev","FIX-24"
"Story 8.5: [FE] Web Correlation Propagation Support","Story","Story 8.5: [FE] Web Correlation Propagation Support

Status: ready-for-dev

Story

As a web diagnostics user,
I want correlation id included in web error/report contexts,
So that support can trace incidents quickly.

Acceptance Criteria

- Given backend returns correlation header When FE handles response Then id is attached to error/report context.
- Given visible error state When rendered Then support trace key can be surfaced where appropriate.
- Given client logging policy When diagnostics emitted Then no sensitive values are included.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 8.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 8.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 8 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 8, Story 8.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 8.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/8-5-web-correlation-propagation-support.md","bmad","epic-8","story-8-5","lane-mixed","bmad-status-ready-for-dev","FIX-24"
"Story 8.6: [MOB] Mobile Correlation Propagation Support","Story","Story 8.6: [MOB] Mobile Correlation Propagation Support

Status: ready-for-dev

Story

As a mobile diagnostics user,
I want correlation id included in mobile failure contexts,
So that incident triage parity with web is maintained.

Acceptance Criteria

- Given API response headers When mobile network layer processes response Then correlation id is captured.
- Given failure UX or support flow When error information shown Then trace id is available for troubleshooting.
- Given crash/error reporting integration When event sent Then correlation id is attached without PII leakage.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 8.
- Supplemental artifact `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` has different scope/numbering; use it only as technical reference, not story ID authority.
- Depends on: Story 8.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 8 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 8, Story 8.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`
- `_bmad-output/implementation-artifacts/epic-8-full-system-validation-and-acceptance-testing.md` (supplemental only)

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 8.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/8-6-mobile-correlation-propagation-support.md","bmad","epic-8","story-8-6","lane-mixed","bmad-status-ready-for-dev","FIX-24"
"Story 9.1: [INT/CH] Execution Orchestration","Story","Story 9.1: [INT/CH] Execution Orchestration

Status: ready-for-dev

Story

As an integration owner,
I want unified orchestration for FEP-routed execution,
So that order paths are controlled through a single domain flow.

Acceptance Criteria

- Given AUTHED order session When execute command issued Then orchestration selects FEP-routed branch correctly.
- Given branch execution completed When results returned Then channel state reflects downstream outcome deterministically.
- Given downstream timeout/failure When execution path fails Then recovery-eligible state is assigned.
- Given orchestration logic update When integration tests run Then both branches remain green.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 9.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 4.3, Story 5.2, Story 5.3, Story 3.2.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 9 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 9, Story 9.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 9.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/9-1-execution-orchestration.md","bmad","epic-9","story-9-1","lane-mixed","bmad-status-ready-for-dev","FIX-25"
"Story 9.2: [INT/CH] End-state Normalization","Story","Story 9.2: [INT/CH] End-state Normalization

Status: ready-for-dev

Story

As a platform consumer,
I want normalized order terminal states,
So that clients can render outcomes without service-specific branching.

Acceptance Criteria

- Given branch-specific outcomes When response is normalized Then terminal states follow common contract.
- Given failed order When failure code is set Then reason taxonomy matches documented categories.
- Given completed order When response returned Then order reference is always present.
- Given state contract regression When tests run Then schema mismatch fails CI.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 9.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 9.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 9 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 9, Story 9.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 9.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/9-2-end-state-normalization.md","bmad","epic-9","story-9-2","lane-mixed","bmad-status-ready-for-dev","FIX-25"
"Story 9.3: [INT/CH] Recovery Scheduler Integration","Story","Story 9.3: [INT/CH] Recovery Scheduler Integration

Status: ready-for-dev

Story

As a reliability owner,
I want orchestrated recovery for EXECUTING/UNKNOWN orders,
So that stuck orders eventually converge.

Acceptance Criteria

- Given order remains non-terminal beyond threshold When scheduler runs Then recovery sequence is triggered.
- Given external requery returns terminal result When reconciliation succeeds Then order is closed with normalized state.
- Given repeated unresolved attempts When max tries exceeded Then manual recovery queue entry is created.
- Given recovery execution When audited Then attempt history is queryable.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 9.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 9.1, Story 6.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 9 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 9, Story 9.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 9.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/9-3-recovery-scheduler-integration.md","bmad","epic-9","story-9-3","lane-mixed","bmad-status-ready-for-dev","FIX-25"
"Story 9.4: [INT/CH] Cross-system Idempotency Reconciliation","Story","Story 9.4: [INT/CH] Cross-system Idempotency Reconciliation

Status: ready-for-dev

Story

As an integration data owner,
I want idempotency reconciled across CH/AC/FEP,
So that duplicate operations never diverge across system boundaries.

Acceptance Criteria

- Given duplicate request at channel boundary When dedupe applies Then same canonical outcome is returned.
- Given AC/FEP partial records When reconciliation runs Then canonical order identity is restored.
- Given mismatch detection When discovered Then inconsistency is surfaced to operations.
- Given reconciliation run report When completed Then success/failure counters are emitted.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 9.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 5.4, Story 3.3, Story 9.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 9 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 9, Story 9.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 9.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/9-4-cross-system-idempotency-reconciliation.md","bmad","epic-9","story-9-4","lane-mixed","bmad-status-ready-for-dev","FIX-25"
"Story 9.5: [FE] Integrated Final-state & Retry UX","Story","Story 9.5: [FE] Integrated Final-state & Retry UX

Status: ready-for-dev

Story

As a web user,
I want integrated final-state and retry guidance,
So that complex backend outcomes are understandable.

Acceptance Criteria

- Given normalized terminal response When FE renders result Then completed/failed states are displayed consistently.
- Given recovery-in-progress state When user views order status Then proper pending/retry guidance is shown.
- Given retry-eligible failure When user triggers retry action Then operation follows guarded flow.
- Given unknown status resolution When final state arrives Then UI auto-updates without stale conflict.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 9.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 9.2, Story 4.5.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 9 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 9, Story 9.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 9.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/9-5-integrated-final-state-and-retry-ux.md","bmad","epic-9","story-9-5","lane-mixed","bmad-status-ready-for-dev","FIX-25"
"Story 9.6: [MOB] Integrated Final-state & Retry UX","Story","Story 9.6: [MOB] Integrated Final-state & Retry UX

Status: ready-for-dev

Story

As a mobile user,
I want integrated final-state and retry guidance on mobile,
So that order completion behavior is parity with web.

Acceptance Criteria

- Given normalized final response When mobile renders result Then status/reason/ref fields follow same semantics as web.
- Given recovery-in-progress condition When screen revisited Then current status is restored and shown accurately.
- Given retryable failure condition When user retries Then guarded action path executes and prevents duplicates.
- Given connectivity interruption When app resumes Then latest order state is re-synced.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 9.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 9.2, Story 4.7.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 9 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 9, Story 9.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 9.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/9-6-integrated-final-state-and-retry-ux.md","bmad","epic-9","story-9-6","lane-mixed","bmad-status-ready-for-dev","FIX-25"
"Story 10.1: [INT/CH] 7+1 Acceptance CI Gate","Story","Story 10.1: [INT/CH] 7+1 Acceptance CI Gate

Status: ready-for-dev

Story

As a release owner,
I want mandatory acceptance scenarios in CI,
So that release quality baseline is objectively enforced.

Acceptance Criteria

- Given protected branch policy When PR to main is opened Then all 7+1 scenarios must pass before merge.
- Given scenario regression When any scenario fails Then merge gate is blocked.
- Given scenario tagging policy When tests run Then scenario IDs are traceable in test reports.
- Given CI report artifact policy When pipeline completes Then evidence artifacts are stored.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 10.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 9.4, Story 7.7, Story 8.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 10 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 10, Story 10.1)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 10.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/10-1-7-plus-1-acceptance-ci-gate.md","bmad","epic-10","story-10-1","lane-mixed","bmad-status-ready-for-dev","FIX-26"
"Story 10.2: [AC] Concurrency/Performance Gate","Story","Story 10.2: [AC] Concurrency/Performance Gate

Status: ready-for-dev

Story

As a performance owner,
I want concurrency and latency gates,
So that release does not regress runtime safety or responsiveness.

Acceptance Criteria

- Given concurrency scenario suite When CI executes tests Then race/integrity assertions pass.
- Given p95 SLA thresholds When perf tests run Then configured targets are satisfied.
- Given threshold breach When observed Then release gate fails with metric evidence.
- Given repeated benchmark runs When compared Then unacceptable variance is reported.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 10.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 5.5, Story 9.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 10 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 10, Story 10.2)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 10.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/10-2-concurrency-performance-gate.md","bmad","epic-10","story-10-2","lane-mixed","bmad-status-ready-for-dev","FIX-26"
"Story 10.3: [FEP] FEP Resilience Drills","Story","Story 10.3: [FEP] FEP Resilience Drills

Status: ready-for-dev

Story

As a FEP owner,
I want repeatable resilience drills,
So that operational recovery confidence is proven.

Acceptance Criteria

- Given timeout and failure drill setup When test run executes Then CB open behavior is verified.
- Given recovery drill scenario When downstream recovers Then state closes and normal flow resumes.
- Given replay/requery drill When unresolved order simulated Then recovery workflow converges or escalates as designed.
- Given drill evidence requirement When drill completes Then report/log artifacts are attached.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 10.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 6.6, Story 9.3.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 10 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 10, Story 10.3)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 10.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/10-3-fep-resilience-drills.md","bmad","epic-10","story-10-3","lane-fep","bmad-status-ready-for-dev","FIX-26"
"Story 10.4: [INT/CH] Full-stack Smoke & Rehearsal","Story","Story 10.4: [INT/CH] Full-stack Smoke & Rehearsal

Status: ready-for-dev

Story

As a release manager,
I want full-stack smoke and rehearsal flow,
So that deployment readiness is validated before production cut.

Acceptance Criteria

- Given fresh environment boot When compose stack starts Then health endpoints are green within threshold.
- Given critical API/docs endpoints When smoke checks run Then mandatory endpoints respond correctly.
- Given rollback rehearsal plan When exercise performed Then recovery procedure is executable and documented.
- Given rehearsal completion When reviewed Then go/no-go checklist can be updated.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 10.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 10.1.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 10 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 10, Story 10.4)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 10.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/10-4-full-stack-smoke-and-rehearsal.md","bmad","epic-10","story-10-4","lane-mixed","bmad-status-ready-for-dev","FIX-26"
"Story 10.5: [FE] Web Release Readiness Pack","Story","Story 10.5: [FE] Web Release Readiness Pack

Status: ready-for-dev

Story

As a web release owner,
I want FE E2E and release evidence packaged,
So that web deployment quality is auditable.

Acceptance Criteria

- Given FE E2E suite When release pipeline runs Then critical user journeys pass.
- Given regression in core order/auth paths When detected Then release gate fails.
- Given release checklist template When preparing shipment Then checklist items are completed with evidence links.
- Given final FE candidate build When validated Then versioned release notes are generated.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 10.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 9.5, Story 10.1, Story 10.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 10 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 10, Story 10.5)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 10.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/10-5-web-release-readiness-pack.md","bmad","epic-10","story-10-5","lane-mixed","bmad-status-ready-for-dev","FIX-26"
"Story 10.6: [MOB] Mobile Release Readiness Pack","Story","Story 10.6: [MOB] Mobile Release Readiness Pack

Status: ready-for-dev

Story

As a mobile release owner,
I want MOB E2E and release evidence packaged,
So that mobile deployment quality is auditable.

Acceptance Criteria

- Given MOB E2E suite When release pipeline runs Then critical flows pass on target test matrix.
- Given auth/order/notification regressions When detected Then release gate fails.
- Given release checklist template When preparing distribution Then checklist and artifact links are completed.
- Given final build candidate When approved Then release notes and handoff package are finalized.

Tasks / Subtasks

- [ ] Implement acceptance-criteria scope 1 (AC: 1)
  - [ ] Add test coverage for AC 1
- [ ] Implement acceptance-criteria scope 2 (AC: 2)
  - [ ] Add test coverage for AC 2
- [ ] Implement acceptance-criteria scope 3 (AC: 3)
  - [ ] Add test coverage for AC 3
- [ ] Implement acceptance-criteria scope 4 (AC: 4)
  - [ ] Add test coverage for AC 4

Dev Notes

Developer Context Section

- Canonical numbering source: `_bmad-output/planning-artifacts/epics.md` Epic 10.
- No supplemental epic artifact detected for this epic at generation time.
- Depends on: Story 9.6, Story 10.1, Story 10.4.

Technical Requirements

- Implement only the scope defined in this story's acceptance criteria.
- Keep API, error, and ownership semantics consistent with architecture and PRD contracts.
- Avoid cross-lane coupling outside required integration boundaries.

Architecture Compliance

- Follow architecture-defined module boundaries, security contracts, and error envelope conventions.
- Keep lane ownership explicit (BE/FE/MOB) and avoid logic duplication across clients/services.

Testing Requirements

- Validate all acceptance criteria with automated tests (unit/integration/e2e as appropriate).
- Ensure negative paths and validation/authorization/error flows are covered.

Story Completion Status

- Status set to `ready-for-dev`.
- Completion note: Epic 10 story context prepared from canonical planning artifact.

References

- `_bmad-output/planning-artifacts/epics.md` (Epic 10, Story 10.6)
- `_bmad-output/planning-artifacts/architecture.md`
- `_bmad-output/planning-artifacts/prd.md`

Dev Agent Record

Agent Model Used

GPT-5 Codex (Codex desktop)

Debug Log References

- Generated from canonical planning artifact for Epic 10.

Completion Notes List

- Story scaffold generated with canonical numbering guardrail.

File List

- /Users/yeongjae/fixyz/_bmad-output/implementation-artifacts/10-6-mobile-release-readiness-pack.md","bmad","epic-10","story-10-6","lane-mixed","bmad-status-ready-for-dev","FIX-26"
